<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v1.7 plugin-docs plugin-id-default docs-doc-id-developer-guide/custom-scheduling-policies">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Custom Scheduling Policies | Koordinator</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://koordinator.sh/docs/developer-guide/custom-scheduling-policies"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v1.7"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v1.7"><meta data-rh="true" name="docsearch:version" content="v1.7"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v1.7"><meta data-rh="true" property="og:title" content="Custom Scheduling Policies | Koordinator"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://koordinator.sh/docs/developer-guide/custom-scheduling-policies"><link data-rh="true" rel="alternate" href="https://koordinator.sh/docs/developer-guide/custom-scheduling-policies" hreflang="en"><link data-rh="true" rel="alternate" href="https://koordinator.sh/zh-Hans/docs/developer-guide/custom-scheduling-policies" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://koordinator.sh/docs/developer-guide/custom-scheduling-policies" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://FKASWWQYOP-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Koordinator RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Koordinator Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Koordinator" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.d55f2266.css">
<link rel="preload" href="/assets/js/runtime~main.30362139.js" as="script">
<link rel="preload" href="/assets/js/main.3bf8fee7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">‚≠êÔ∏è If you like Koordinator, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/koordinator-sh/koordinator">GitHub</a>! ‚≠êÔ∏è</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Koordinator" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Koordinator" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Koordinator</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Documentation</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/">v1.7</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/developer-guide/custom-scheduling-policies">v1.8 üöß</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/developer-guide/custom-scheduling-policies">v1.7</a></li><li><a class="dropdown__link" href="/docs/v1.6/">v1.6</a></li><li><a class="dropdown__link" href="/docs/v1.5/">v1.5</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/developer-guide/custom-scheduling-policies" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh-Hans/docs/developer-guide/custom-scheduling-policies" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">ÁÆÄ‰Ωì‰∏≠Êñá</a></li></ul></div><a href="https://github.com/koordinator-sh/koordinator" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docs/">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation">Installation</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docs/architecture/overview">Architecture</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/resource-model">Resource Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/priority">Priority</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/qos">QoS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/job">Job</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture/device">Device</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/user-manuals/gang-scheduling">User Manuals</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/designs/koordlet-overview">Design Details</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/best-practices/batch-colocation-quick-start">Best Practices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/developer-guide/component-guide">Developer Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer-guide/component-guide">Component Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer-guide/metrics-collection">Metrics Collection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer-guide/extensibility">Extensibility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer-guide/plugin-development">Developing Custom Scheduler Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/developer-guide/custom-scheduling-policies">Custom Scheduling Policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer-guide/webhook-extensions">Webhook Extensions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer-guide/develop-custom-deschedule-plugins">Developing Custom Descheduler Plugin</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/api-reference/custom-resource-definitions">API Reference</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Developer Guide</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Custom Scheduling Policies</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v1.7</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Custom Scheduling Policies</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">‚Äã</a></h2><p>Koordinator provides an extensible scheduling framework for developing custom policies addressing specific workload requirements. This document details existing plugin implementations (co-scheduling, device sharing, elastic quota) as examples for building new policies. The framework extends Kubernetes scheduling with well-defined interfaces, enabling sophisticated resource management that integrates seamlessly with Koordinator.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="scheduling-framework-extension-points">Scheduling Framework Extension Points<a href="#scheduling-framework-extension-points" class="hash-link" aria-label="Direct link to Scheduling Framework Extension Points" title="Direct link to Scheduling Framework Extension Points">‚Äã</a></h2><p>Koordinator&#x27;s framework provides extension points for custom plugins to participate in scheduling at various stages. The framework extender factory manages plugin registration, enabling plugins to access Koordinator-specific resources through the ExtendedHandle interface.</p><p>Plugins register via PluginFactoryProxy, which passes FrameworkExtender as the handle parameter. Key extension interfaces include SchedulingTransformer (modify scheduling state), ReservationRestorePlugin (manage reserved resources), and AllocatePlugin (fine-grained resource allocation). The framework also supports ResizePodPlugin (modify pod resources before assume) and PreBindExtensions (apply patches during binding).</p><p>The framework maintains a plugin registry per profile, allowing different plugin sets for different scenarios. When scheduling begins, the framework extender is created for the specific profile, and plugins are initialized at appropriate extension points.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/frameworkext/framework_extender_factory.go#L103-L390" target="_blank" rel="noopener noreferrer">framework_extender_factory.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/frameworkext/interface.go#L37-L268" target="_blank" rel="noopener noreferrer">interface.go</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-of-key-scheduling-policies">Implementation of Key Scheduling Policies<a href="#implementation-of-key-scheduling-policies" class="hash-link" aria-label="Direct link to Implementation of Key Scheduling Policies" title="Direct link to Implementation of Key Scheduling Policies">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="co-scheduling-policy-implementation">Co-Scheduling Policy Implementation<a href="#co-scheduling-policy-implementation" class="hash-link" aria-label="Direct link to Co-Scheduling Policy Implementation" title="Direct link to Co-Scheduling Policy Implementation">‚Äã</a></h3><p>The co-scheduling policy ensures related pods are scheduled together, preventing partial deployments. Implemented through pod annotations defining gang membership, minimum available count, and scheduling mode (strict/non-strict).</p><p>Leverages Permit and PreBind extension points to coordinate gang member scheduling. During Permit, the scheduler checks if sufficient resources exist for minimum required pods. If insufficient, all gang members are delayed until resources are available or timeout occurs. Supports network topology awareness for connectivity requirements.</p><p>Handles partial failures and dynamic membership changes. In strict mode, pod failures abort entire gang scheduling. Non-strict mode proceeds with reduced pods, balancing reliability and resource efficiency.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/apis/extension/coscheduling.go#L0-L166" target="_blank" rel="noopener noreferrer">coscheduling.go</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="device-sharing-policy-implementation">Device Sharing Policy Implementation<a href="#device-sharing-policy-implementation" class="hash-link" aria-label="Direct link to Device Sharing Policy Implementation" title="Direct link to Device Sharing Policy Implementation">‚Äã</a></h3><p>The device sharing policy enables efficient utilization of specialized hardware (GPUs, FPGAs, RDMA) by allowing multiple pods to share these resources. Provides fine-grained control through annotations specifying allocation strategies, topology requirements, and exclusive policies.</p><p>Components:</p><ul><li><strong>PreFilter</strong>: Analyzes pod requests and extracts device requirements from annotations</li><li><strong>Filter</strong>: Evaluates node suitability based on available devices and topology</li><li><strong>Reserve</strong>: Allocates specific devices and updates node cache</li><li><strong>PreBind</strong>: Injects device allocation into pod annotations for device plugins</li></ul><p>Supports joint allocation of multiple device types, ensuring related devices (GPU and memory) are allocated from the same physical unit for optimal performance. Supports hierarchical topology scopes (device, PCIe, NUMA, node) for allocation constraints.</p><p><strong>Device Sharing Plugin Class Structure:</strong></p><p>Core classes and relationships:</p><ul><li><p><strong>DeviceSharePlugin</strong> (Device sharing plugin)</p><ul><li>Methods: <code>Name()</code>, <code>PreFilter()</code>, <code>Filter()</code>, <code>Reserve()</code>, <code>PreBind()</code></li><li>Manages DeviceAllocations</li><li>Uses DeviceAllocateHints</li></ul></li><li><p><strong>DeviceAllocations</strong> (Device allocation set)</p><ul><li>Fields: <code>DeviceType[]</code>, <code>Resources ResourceList</code>, <code>ID string</code></li><li>Contains DeviceAllocation (single device allocation)</li></ul></li><li><p><strong>DeviceAllocateHints</strong> (Device allocation hints)</p><ul><li>Fields: <code>Selector LabelSelector</code></li><li><code>AllocateStrategy DeviceAllocateStrategy</code> (allocation strategy)</li><li><code>RequiredTopologyScope DeviceTopologyScope</code> (topology scope)</li></ul></li></ul><p><strong>Diagram sources </strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/apis/extension/device_share.go#L0-L394" target="_blank" rel="noopener noreferrer">device_share.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/plugins/deviceshare/plugin.go#L0-L727" target="_blank" rel="noopener noreferrer">plugin.go</a></li></ul><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/apis/extension/device_share.go#L0-L394" target="_blank" rel="noopener noreferrer">device_share.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/plugins/deviceshare/plugin.go#L0-L727" target="_blank" rel="noopener noreferrer">plugin.go</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="elastic-quota-policy-implementation">Elastic Quota Policy Implementation<a href="#elastic-quota-policy-implementation" class="hash-link" aria-label="Direct link to Elastic Quota Policy Implementation" title="Direct link to Elastic Quota Policy Implementation">‚Äã</a></h3><p>The elastic quota policy provides hierarchical quota management with flexible resource allocation across teams and applications. Unlike traditional Kubernetes quotas, supports resource borrowing between siblings and dynamic adjustment based on usage.</p><p>Uses a tree structure with parent quotas governing total limits for children. Each quota specifies minimum guaranteed resources and maximum limits, with ability to lend unused resources to other quotas in the subtree. Tracks allocated and actual usage for accurate admission control and reclaiming.</p><p>Integrates via PreFilter and Reserve extension points. PreFilter checks if resources are available within the pod&#x27;s quota, considering guaranteed and borrowable resources. Reserve updates quota usage and prevents over-allocation. Includes controllers for quota lifecycle and resource reclaiming when quotas exceed limits.</p><p><strong>Elastic Quota Plugin Class Structure:</strong></p><p>Core classes and relationships:</p><ul><li><p><strong>ElasticQuotaPlugin</strong> (Elastic quota plugin)</p><ul><li>Methods: <code>Name()</code>, <code>PreFilter()</code>, <code>PostFilter()</code>, <code>Reserve()</code>, <code>Unreserve()</code></li><li>Uses GroupQuotaManager</li><li>Accesses QuotaInfo</li></ul></li><li><p><strong>GroupQuotaManager</strong> (Group quota manager)</p><ul><li>Methods: <code>GetQuotaInfoByName()</code>, <code>ReservePod()</code>, <code>UnreservePod()</code>, <code>InitHookPlugins()</code></li><li>Manages QuotaInfo</li></ul></li><li><p><strong>QuotaInfo</strong> (Quota information)</p><ul><li>Fields: <code>Name string</code></li><li><code>Min ResourceList</code> (minimum guaranteed resources)</li><li><code>Max ResourceList</code> (maximum limit resources)</li><li><code>Used ResourceList</code> (used resources)</li><li><code>NonPreemptibleUsed ResourceList</code> (non-preemptible resources)</li></ul></li></ul><p><strong>Diagram sources </strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/apis/extension/elastic_quota.go#L0-L232" target="_blank" rel="noopener noreferrer">elastic_quota.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/plugins/elasticquota/plugin.go#L0-L377" target="_blank" rel="noopener noreferrer">plugin.go</a></li></ul><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/apis/extension/elastic_quota.go#L0-L232" target="_blank" rel="noopener noreferrer">elastic_quota.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/plugins/elasticquota/plugin.go#L0-L377" target="_blank" rel="noopener noreferrer">plugin.go</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="policy-integration-and-configuration">Policy Integration and Configuration<a href="#policy-integration-and-configuration" class="hash-link" aria-label="Direct link to Policy Integration and Configuration" title="Direct link to Policy Integration and Configuration">‚Äã</a></h2><p>Integrating custom policies requires careful configuration and parameter tuning. Policies configure through scheduler&#x27;s component configuration with enable/disable controls and specific parameters. Configuration supports static and dynamic reloading without scheduler restarts.</p><p>Key parameters include resource scoring strategies, timeout values, and topology constraints. Device sharing configures GPU templates and topology alignment. Elastic quota configures minimum scaling and system quota limits. Parameters tune based on cluster characteristics and workload requirements.</p><p>Follow established patterns for error handling and logging. Provide clear error messages explaining scheduling decisions. Use framework utilities for diagnostics and metrics to facilitate troubleshooting.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/frameworkext/framework_extender_factory.go#L103-L390" target="_blank" rel="noopener noreferrer">framework_extender_factory.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/frameworkext/interface.go#L37-L268" target="_blank" rel="noopener noreferrer">interface.go</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-development-challenges-and-solutions">Common Development Challenges and Solutions<a href="#common-development-challenges-and-solutions" class="hash-link" aria-label="Direct link to Common Development Challenges and Solutions" title="Direct link to Common Development Challenges and Solutions">‚Äã</a></h2><p>Developing custom policies presents several common challenges:</p><ol><li><strong>Race Conditions</strong>: During concurrent scheduling, use framework&#x27;s state management and atomic resource updates</li><li><strong>Partial Failures</strong>: Handle unavailable components with retry mechanisms and fallback strategies</li><li><strong>Performance Optimization</strong>: Minimize expensive operations in critical paths and leverage caching</li><li><strong>Backward Compatibility</strong>: Introduce new features behind feature gates and maintain deprecated functionality</li></ol><p>Utilize framework mechanisms for parallelizing operations and optimizing resource filtering. Ensure comprehensive testing including unit, integration, and end-to-end tests for policy correctness and performance.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/frameworkext/framework_extender_factory.go#L103-L390" target="_blank" rel="noopener noreferrer">framework_extender_factory.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/frameworkext/interface.go#L37-L268" target="_blank" rel="noopener noreferrer">interface.go</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">‚Äã</a></h2><p>Koordinator&#x27;s extensible scheduling framework provides a robust foundation for developing custom policies addressing specific workload requirements. By understanding existing policy implementations (co-scheduling, device sharing, elastic quotas), developers can create sophisticated resource management solutions that integrate seamlessly with Kubernetes. The framework&#x27;s well-defined extension points, comprehensive interfaces, and modular architecture enable policies that enhance resource utilization, improve performance, and simplify cluster management.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/koordinator-sh/koordinator.sh/edit/main/docs/developer-guide/custom-scheduling-policies.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-10-31T03:46:30.000Z">Oct 31, 2025</time></b> by <b>‰πîÊôÆ</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/developer-guide/plugin-development"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Developing Custom Scheduler Plugin</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/developer-guide/webhook-extensions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Webhook Extensions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#scheduling-framework-extension-points" class="table-of-contents__link toc-highlight">Scheduling Framework Extension Points</a></li><li><a href="#implementation-of-key-scheduling-policies" class="table-of-contents__link toc-highlight">Implementation of Key Scheduling Policies</a><ul><li><a href="#co-scheduling-policy-implementation" class="table-of-contents__link toc-highlight">Co-Scheduling Policy Implementation</a></li><li><a href="#device-sharing-policy-implementation" class="table-of-contents__link toc-highlight">Device Sharing Policy Implementation</a></li><li><a href="#elastic-quota-policy-implementation" class="table-of-contents__link toc-highlight">Elastic Quota Policy Implementation</a></li></ul></li><li><a href="#policy-integration-and-configuration" class="table-of-contents__link toc-highlight">Policy Integration and Configuration</a></li><li><a href="#common-development-challenges-and-solutions" class="table-of-contents__link toc-highlight">Common Development Challenges and Solutions</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/developer-guide/docs/installation">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/developer-guide/docs/user-manuals/colocation-profile">User Manuals</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/developer-guide/docs/architecture/overview">Architecture</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/koordinator-sh/shared_invite/zt-1756qoub4-Cn4~esfdlfAPsD7cwO2NzA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack ( #koordinator channel )<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/developer-guide/">DingTalk (GroupID: 33383887)</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/koordinator-sh/koordinator" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/developer-guide/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <div style="font-size: 18px">
        <br>
        <strong>Koordinator is a <a href="https://www.cncf.io/">Cloud Native Computing Foundation</a> sandbox project</strong>
        <br>
        </div>
        <br>
        <img src="img/cncf-color.svg" alt="CNCF" width="auto" height="100px">
        <br>
        <div style="font-size: 14px">
        The Linux Foundation¬Æ (TLF) has registered trademarks and uses trademarks. For a list of TLF trademarks, see <a href="https://www.linuxfoundation.org/trademark-usage/">Trademark Usage</a>.
        <br>
        Copyright ¬© 2025 The Koordinator Authors. All rights reserved.
        </div>
        </div></div></div></footer></div>
<script src="/assets/js/runtime~main.30362139.js"></script>
<script src="/assets/js/main.3bf8fee7.js"></script>
</body>
</html>