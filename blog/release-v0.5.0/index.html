<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Koordinator v0.5: Now With Node Resource Topology And More | Koordinator</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://koordinator.sh/blog/release-v0.5.0"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Koordinator v0.5: Now With Node Resource Topology And More | Koordinator"><meta data-rh="true" name="description" content="In addition to the usual updates to supporting utilities, Koordinator v0.5 adds a couple of new useful features we think"><meta data-rh="true" property="og:description" content="In addition to the usual updates to supporting utilities, Koordinator v0.5 adds a couple of new useful features we think"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-06-30T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/jasonliu747"><meta data-rh="true" property="article:tag" content="release"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://koordinator.sh/blog/release-v0.5.0"><link data-rh="true" rel="alternate" href="https://koordinator.sh/blog/release-v0.5.0" hreflang="en"><link data-rh="true" rel="alternate" href="https://koordinator.sh/zh-Hans/blog/release-v0.5.0" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://koordinator.sh/blog/release-v0.5.0" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://FKASWWQYOP-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Koordinator RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Koordinator Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Koordinator" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.d55f2266.css">
<link rel="preload" href="/assets/js/runtime~main.75f70c36.js" as="script">
<link rel="preload" href="/assets/js/main.32666d36.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">‚≠êÔ∏è If you like Koordinator, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/koordinator-sh/koordinator">GitHub</a>! ‚≠êÔ∏è</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Koordinator" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Koordinator" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Koordinator</b></a><a class="navbar__item navbar__link" href="/docs">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/">v1.4</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/">v1.5 üöß</a></li><li><a class="dropdown__link" href="/docs/">v1.4</a></li><li><a class="dropdown__link" href="/docs/v1.3/">v1.3</a></li><li><a class="dropdown__link" href="/docs/v1.2/">v1.2</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/blog/release-v0.5.0" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh-Hans/blog/release-v0.5.0" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">ÁÆÄ‰Ωì‰∏≠Êñá</a></li></ul></div><a href="https://github.com/koordinator-sh/koordinator" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/release-v1.4.0">Koordinator v1.4: more types of computing workloads and more flexible resource management mechanisms</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/release-v1.3.0">Koordinator v1.3: Â¢ûÂº∫ËµÑÊ∫êÈ¢ÑÁïôÔºåÊîØÊåÅ NRIÔºåÊèê‰æõËäÇÁÇπÁîªÂÉèÁöÑ Mid ËµÑÊ∫êË∂ÖÂçñ</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/release-v1.2.0">Koordinator v1.2: ÊîØÊåÅËäÇÁÇπËµÑÊ∫êÈ¢ÑÁïôÔºåÂÖºÂÆπÁ§æÂå∫ÈáçË∞ÉÂ∫¶Á≠ñÁï•</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/anolis-CPU-Co-location">ÈæôËú• plugsched Á•ûÂô®Âä©Âäõ Koordinator ‰∫ëÂéüÁîüÂçïÊú∫Ê∑∑ÈÉ®‚Äî‚Äî ÂÜÖÊ†∏ CPU QoS Êè≠Áßò</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/release-v1.1.0">Koordinator v1.1: ËÆ©Ë∞ÉÂ∫¶ÊÑüÁü•Ë¥üËΩΩ‰∏éÂπ≤Êâ∞Ê£ÄÊµãÈááÈõÜ</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/release-v1.0.0">Koordinator v1.0: Ê≠£ÂºèÂèëÂ∏É</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/release-v0.7.0">Koordinator v0.7: ‰∏∫‰ªªÂä°Ë∞ÉÂ∫¶È¢ÜÂüüÊ≥®ÂÖ•Êñ∞Ê¥ªÂäõ</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/release-v0.6.0">Koordinator v0.6: Complete fine-grained CPU orchestration, Resource Reservation and Descheduling</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/release-v0.5.0">Koordinator v0.5: Now With Node Resource Topology And More</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/release-v0.4.0">What&#x27;s New in Koordinator v0.4.0?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/release-v0.3.0">What&#x27;s New in Koordinator v0.3.0?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/release-v0.2.0">Koordinator v0.2.0 - Enhanced node-side scheduling capabilities</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/release-v0.1.0">Koordinator v0.1.0 - QoS based scheduling system</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Koordinator v0.5: Now With Node Resource Topology And More</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-06-30T00:00:00.000Z" itemprop="datePublished">June 30, 2022</time> ¬∑ <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/jasonliu747" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/jasonliu747.png" alt="Jason"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/jasonliu747" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Jason</span></a></div><small class="avatar__subtitle" itemprop="description">Koordinator maintainer</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>In addition to the usual updates to supporting utilities, Koordinator v0.5 adds a couple of new useful features we think
you&#x27;ll like.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-or-upgrade-to-koordinator-v050">Install or Upgrade to Koordinator v0.5.0<a href="#install-or-upgrade-to-koordinator-v050" class="hash-link" aria-label="Direct link to Install or Upgrade to Koordinator v0.5.0" title="Direct link to Install or Upgrade to Koordinator v0.5.0">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-with-helms">Install with helms<a href="#install-with-helms" class="hash-link" aria-label="Direct link to Install with helms" title="Direct link to Install with helms">‚Äã</a></h3><p>Koordinator can be simply installed by helm v3.5+, which is a simple command-line tool, and you can get it
from <a href="https://github.com/helm/helm/releases" target="_blank" rel="noopener noreferrer">here</a>.</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Firstly add koordinator charts repository if you haven&#x27;t do this.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm repo </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> koordinator-sh https://koordinator-sh.github.io/charts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># [Optional]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Install the latest version.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> koordinator koordinator-sh/koordinator --version </span><span class="token number" style="color:#36acaa">0.5</span><span class="token plain">.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-with-helm">Upgrade with helm<a href="#upgrade-with-helm" class="hash-link" aria-label="Direct link to Upgrade with helm" title="Direct link to Upgrade with helm">‚Äã</a></h3><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Firstly add koordinator charts repository if you haven&#x27;t do this.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm repo </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> koordinator-sh https://koordinator-sh.github.io/charts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># [Optional]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Upgrade the latest version.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm upgrade koordinator koordinator-sh/koordinator --version </span><span class="token number" style="color:#36acaa">0.5</span><span class="token plain">.0 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--force</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For more details, please refer to the <a href="/docs/installation">installation manual</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fine-grained-cpu-orchestration">Fine-grained CPU Orchestration<a href="#fine-grained-cpu-orchestration" class="hash-link" aria-label="Direct link to Fine-grained CPU Orchestration" title="Direct link to Fine-grained CPU Orchestration">‚Äã</a></h2><p>In this version, we introduced a fine-grained CPU orchestration. Pods in the Kubernetes cluster may interfere with
others&#x27; running when they share the same physical resources and both demand many resources. The sharing of CPU resources
is almost inevitable. e.g. SMT threads (i.e. logical processors) share execution units of the same core, and cores in
the same chip share one last-level cache. The resource contention can slow down the running of these CPU-sensitive
workloads, resulting in high response latency (RT).</p><p>To improve the performance of CPU-sensitive workloads, koord-scheduler provides a mechanism of fine-grained CPU
orchestration. It enhances the CPU management of Kubernetes and supports detailed NUMA-locality and CPU exclusions.</p><p>Please check out our <a href="/docs/user-manuals/fine-grained-cpu-orchestration">user manual</a> for a detailed introduction and
tutorial.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resource-reservation">Resource Reservation<a href="#resource-reservation" class="hash-link" aria-label="Direct link to Resource Reservation" title="Direct link to Resource Reservation">‚Äã</a></h2><p>Pods are fundamental units for allocating node resources in Kubernetes, which bind resource requirements with business
logic. The scheduler is not able to reserve node resources for specific pods or workloads. We may try using a fake pod
to prepare resources by the preemption mechanism. However, fake pods can be preempted by any scheduled pods with higher
priorities, which make resources get scrambled unexpectedly.</p><p>In Koordinator, a resource reservation mechanism is proposed to enhance scheduling and especially benefits scenarios
below:</p><ol><li>Preemption: Existing preemption does not guarantee that only preempting pods can allocate preempted resources. With a
reservation, the scheduler should be able to &quot;lock&quot; resources preventing from allocation of other pods with the same
or
higher priority.</li><li>De-scheduling: For the descheduler, it is better to ensure sufficient resources with the reservation before pods get
rescheduled. Otherwise, rescheduled pods may not be runnable anymore and make the belonging application disrupted.</li><li>Horizontal scaling: Using reservation to achieve more deterministic horizontal scaling. e.g. Submit a reservation and
make sure it is available before scaling up replicas.</li><li>Resource Pre-allocation: Sometimes we want to pre-allocate node resources for future resource demands even if the
resources are not currently allocatable. Reservation can help with this and it should make no physical cost.</li></ol><p>This feature is still under development. We&#x27;ve finalized the API, feel free to check it out.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type Reservation struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metav1.TypeMeta `json:&quot;,inline&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // A Reservation object is non-namespaced.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // It can reserve resources for pods of any namespace. Any affinity/anti-affinity of reservation scheduling can be</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // specified in the pod template.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metav1.ObjectMeta `json:&quot;metadata,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Spec              ReservationSpec   `json:&quot;spec,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status            ReservationStatus `json:&quot;status,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type ReservationSpec struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Template defines the scheduling requirements (resources, affinities, images, ...) processed by the scheduler just</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // like a normal pod.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // If the `template.spec.nodeName` is specified, the scheduler will not choose another node but reserve resources on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // the specified node.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Template *corev1.PodTemplateSpec `json:&quot;template,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Specify the owners who can allocate the reserved resources.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Multiple owner selectors and ANDed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Owners []ReservationOwner `json:&quot;owners,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // By default, the resources requirements of reservation (specified in `template.spec`) is filtered by whether the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // node has sufficient free resources (i.e. ReservationRequest &lt;  NodeFree).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // When `preAllocation` is set, the scheduler will skip this validation and allow overcommitment. The scheduled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // reservation would be waiting to be available until free resources are sufficient.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PreAllocation bool `json:&quot;preAllocation,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Time-to-Live period for the reservation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // `expires` and `ttl` are mutually exclusive. If both `ttl` and `expires` are not specified, a very</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // long TTL will be picked as default.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TTL *metav1.Duration `json:&quot;ttl,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Expired timestamp when the reservation expires.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // `expires` and `ttl` are mutually exclusive. Defaults to being set dynamically at runtime based on the `ttl`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Expires *metav1.Time `json:&quot;expires,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type ReservationStatus struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // The `phase` indicates whether is reservation is waiting for process (`Pending`), available to allocate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // (`Available`) or expired to get cleanup (Expired).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Phase ReservationPhase `json:&quot;phase,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // The `conditions` indicate the messages of reason why the reservation is still pending.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Conditions []ReservationCondition `json:&quot;conditions,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Current resource owners which allocated the reservation resources.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CurrentOwners []corev1.ObjectReference `json:&quot;currentOwners,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type ReservationOwner struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Multiple field selectors are ORed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Object        *corev1.ObjectReference         `json:&quot;object,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Controller    *ReservationControllerReference `json:&quot;controller,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LabelSelector *metav1.LabelSelector           `json:&quot;labelSelector,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type ReservationControllerReference struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Extend with a `namespace` field for reference different namespaces.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metav1.OwnerReference `json:&quot;,inline&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Namespace             string `json:&quot;namespace,omitempty&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type ReservationPhase string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ReservationPending indicates the Reservation has not been processed by the scheduler or is unschedulable for</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // some reasons (e.g. the resource requirements cannot get satisfied).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReservationPending ReservationPhase = &quot;Pending&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ReservationAvailable indicates the Reservation is both scheduled and available for allocation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReservationAvailable ReservationPhase = &quot;Available&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ReservationWaiting indicates the Reservation is scheduled, but the resources to reserve are not ready for</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // allocation (e.g. in pre-allocation for running pods).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReservationWaiting ReservationPhase = &quot;Waiting&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ReservationExpired indicates the Reservation is expired, which the object is not available to allocate and will</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // get cleaned in the future.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ReservationExpired ReservationPhase = &quot;Expired&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type ReservationCondition struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LastProbeTime      metav1.Time `json:&quot;lastProbeTime&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LastTransitionTime metav1.Time `json:&quot;lastTransitionTime&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Reason             string      `json:&quot;reason&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Message            string      `json:&quot;message&quot;`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="qos-manager">QoS Manager<a href="#qos-manager" class="hash-link" aria-label="Direct link to QoS Manager" title="Direct link to QoS Manager">‚Äã</a></h2><p>Currently, plugins from resmanager in Koordlet are mixed together, they should be classified into two
categories: <code>static</code> and <code>dynamic</code>. Static plugins will be called and run only once when a container created, updated,
started or stopped. However, for dynamic plugins, they may be called and run at any time according the real-time runtime
states of node, such as CPU suppress, CPU burst, etc. This proposal only focuses on refactoring dynamic plugins. Take a
look at current plugin implementation, there are many function calls to resmanager&#x27;s methods directly, such as
collecting node/pod/container metrics, fetching metadata of node/pod/container, fetching configurations(NodeSLO, etc.).
In the feature, we may need a flexible and powerful framework with scalability for special external plugins.</p><p>The below is directory tree of qos-manager inside koordlet, all existing dynamic plugins(as built-in plugins) will be
moved into sub-directory <code>plugins</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pkg/koordlet/qosmanager/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       - manager.go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       - context.go   // plugin context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       - /plugins/    // built-in plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 - /cpubrust/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 - /cpusuppress/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 - /cpuevict/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 - /memoryevict/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We only have the proposal in this version. Stay tuned, further implementation is coming soon!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="multiple-running-hook-modes">Multiple Running Hook Modes<a href="#multiple-running-hook-modes" class="hash-link" aria-label="Direct link to Multiple Running Hook Modes" title="Direct link to Multiple Running Hook Modes">‚Äã</a></h2><p><code>Runtime Hooks</code> includes a set of plugins which are responsible for the injections of resource isolation parameters
by pod attribute. When <code>Koord Runtime Proxy</code> running as a CRI Proxy, <code>Runtime Hooks</code> acts as the backend server. The
mechanism of CRI Proxy can ensure the consistency of resource parameters during pod lifecycle. However,
<code>Koord Runtime Proxy</code> can only hijack CRI requests from kubelet for pods, the consistency of resource parameters in
QoS class directory cannot be guaranteed. Besides, modification of pod parameters from third-party(e.g. manually) will
also break the correctness of hook plugins.</p><p>Therefore, a standalone running mode with reconciler for <code>Runtime Hooks</code> is necessary. Under <code>Standalone</code> running
mode, resource isolation parameters will be injected asynchronously, keeping eventual consistency of the injected
parameters for pod and QoS class even without <code>Runtime Hook Manager</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="some-minor-works">Some minor works<a href="#some-minor-works" class="hash-link" aria-label="Direct link to Some minor works" title="Direct link to Some minor works">‚Äã</a></h2><ol><li>We fix the backward compatibility issues reported by our users
in <a href="https://github.com/koordinator-sh/koordinator/issues/310" target="_blank" rel="noopener noreferrer">here</a>. If you&#x27;ve ever encountered similar problem,
please upgrade to the latest version.</li><li>Two more interfaces were added into runtime-proxy. One is <code>PreCreateContainerHook</code>, which could set container
resources setting before creating, and the other is <code>PostStopSandboxHook</code>, which could do the resource setting
garbage collecting before pods deleted.</li><li><code>cpuacct.usage</code> is more precise than <code>cpuacct.stat</code>, and <code>cpuacct.stat</code> is in USER_HZ unit, while <code>cpuacct.usage</code> is
nanoseconds. After thorough discussion, we were on the same page that we replace <code>cpuacct.stat</code> with <code>cpuacct.usage</code>
in koordlet.</li><li>Koordlet needs to keep fetching data from kubelet. Before this version, we only support accessing kubelet via
read-only port over HTTP. Due to security concern, we&#x27;ve enabled HTTPS access in this version. For more details,
please refer to this <a href="https://github.com/koordinator-sh/koordinator/pull/320" target="_blank" rel="noopener noreferrer">PR</a>.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-coming-next-in-koordinator">What‚Äôs coming next in Koordinator<a href="#whats-coming-next-in-koordinator" class="hash-link" aria-label="Direct link to What‚Äôs coming next in Koordinator" title="Direct link to What‚Äôs coming next in Koordinator">‚Äã</a></h2><p>Don&#x27;t forget that Koordinator is developed in the open. You can check out our Github milestone to know more about what
is happening and what we have planned. For more details, please refer to
our <a href="https://github.com/koordinator-sh/koordinator/milestones" target="_blank" rel="noopener noreferrer">milestone</a>. Hope it helps!</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/release">release</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/koordinator-sh/koordinator.sh/edit/main/blog/2022-06-30-release/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/release-v0.6.0"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Koordinator v0.6: Complete fine-grained CPU orchestration, Resource Reservation and Descheduling</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/release-v0.4.0"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">What&#x27;s New in Koordinator v0.4.0?</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#install-or-upgrade-to-koordinator-v050" class="table-of-contents__link toc-highlight">Install or Upgrade to Koordinator v0.5.0</a><ul><li><a href="#install-with-helms" class="table-of-contents__link toc-highlight">Install with helms</a></li><li><a href="#upgrade-with-helm" class="table-of-contents__link toc-highlight">Upgrade with helm</a></li></ul></li><li><a href="#fine-grained-cpu-orchestration" class="table-of-contents__link toc-highlight">Fine-grained CPU Orchestration</a></li><li><a href="#resource-reservation" class="table-of-contents__link toc-highlight">Resource Reservation</a></li><li><a href="#qos-manager" class="table-of-contents__link toc-highlight">QoS Manager</a></li><li><a href="#multiple-running-hook-modes" class="table-of-contents__link toc-highlight">Multiple Running Hook Modes</a></li><li><a href="#some-minor-works" class="table-of-contents__link toc-highlight">Some minor works</a></li><li><a href="#whats-coming-next-in-koordinator" class="table-of-contents__link toc-highlight">What‚Äôs coming next in Koordinator</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/docs/installation">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/docs/user-manuals/colocation-profile">User Manuals</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/docs/architecture/overview">Architecture</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/koordinator-sh/shared_invite/zt-1756qoub4-Cn4~esfdlfAPsD7cwO2NzA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack ( #koordinator channel )<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/blog/">DingTalk (GroupID: 33383887)</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/koordinator-sh/koordinator" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/blog/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <div style="font-size: 18px">
        <br>
        <strong>Koordinator is a <a href="https://www.cncf.io/">Cloud Native Computing Foundation</a> sandbox project.</strong>
        <br>
        </div>
        <br>
        <img src="img/cncf-color.svg" alt="CNCF" width="auto" height="100px">
        <br>
        <div style="font-size: 14px">
        The Linux Foundation¬Æ (TLF) has registered trademarks and uses trademarks. For a list of TLF trademarks, see <a href="https://www.linuxfoundation.org/trademark-usage/">Trademark Usage</a>.
        <br>
        Copyright ¬© 2024 The Koordinator Authors. All rights reserved.
        </div>
        </div></div></div></footer></div>
<script src="/assets/js/runtime~main.75f70c36.js"></script>
<script src="/assets/js/main.32666d36.js"></script>
</body>
</html>