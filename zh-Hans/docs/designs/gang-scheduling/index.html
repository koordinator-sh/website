<!doctype html>
<html class="docs-version-v1.3" lang="zh-Hans" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/zh-Hans/blog/rss.xml" title="Koordinator RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-Hans/blog/atom.xml" title="Koordinator Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Koordinator" href="/zh-Hans/opensearch.xml"><title data-rh="true">GangScheduling | Koordinator</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://koordinator.sh/zh-Hans/docs/designs/gang-scheduling"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="v1.3"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v1.3"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:version" content="v1.3"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v1.3"><meta data-rh="true" property="og:title" content="GangScheduling | Koordinator"><meta data-rh="true" name="description" content="æ¦‚è§ˆ"><meta data-rh="true" property="og:description" content="æ¦‚è§ˆ"><link data-rh="true" rel="icon" href="/zh-Hans/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://koordinator.sh/zh-Hans/docs/designs/gang-scheduling"><link data-rh="true" rel="alternate" href="https://koordinator.sh/docs/designs/gang-scheduling" hreflang="en"><link data-rh="true" rel="alternate" href="https://koordinator.sh/zh-Hans/docs/designs/gang-scheduling" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://koordinator.sh/docs/designs/gang-scheduling" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://FKASWWQYOP-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/zh-Hans/assets/css/styles.48d3146e.css">
<link rel="preload" href="/zh-Hans/assets/js/runtime~main.f1e42344.js" as="script">
<link rel="preload" href="/zh-Hans/assets/js/main.6a11f22b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">è·³åˆ°ä¸»è¦å†…å®¹</a></div><div class="announcementBar_IbjG" role="banner"><div class="announcementBarPlaceholder_NC_W"></div><div class="announcementBarContent_KsVm">â­ï¸ If you like Koordinator, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/koordinator-sh/koordinator">GitHub</a>! â­ï¸</div><button type="button" class="clean-btn close announcementBarClose_FG1z" aria-label="å…³é—­"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-Hans/"><div class="navbar__logo"><img src="/zh-Hans/img/logo.svg" alt="Koordinator" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/zh-Hans/img/logo.svg" alt="Koordinator" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Koordinator</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-Hans/docs">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/zh-Hans/blog">åšå®¢</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/zh-Hans/docs/">v1.3</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-Hans/docs/next/designs/gang-scheduling">v1.4 ğŸš§</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh-Hans/docs/designs/gang-scheduling">v1.3</a></li><li><a class="dropdown__link" href="/zh-Hans/docs/v1.2/designs/gang-scheduling">v1.2</a></li><li><a class="dropdown__link" href="/zh-Hans/docs/v1.1/designs/gang-scheduling">v1.1</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>ç®€ä½“ä¸­æ–‡</span></span></a><ul class="dropdown__menu"><li><a href="/docs/designs/gang-scheduling" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/zh-Hans/docs/designs/gang-scheduling" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">ç®€ä½“ä¸­æ–‡</a></li></ul></div><a href="https://github.com/koordinator-sh/koordinator" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO menuWithAnnouncementBar_x19h"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/zh-Hans/docs/">å¿«é€Ÿå¼€å§‹</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/">ç®€ä»‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/installation">å®‰è£…</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/zh-Hans/docs/architecture/overview">æ¶æ„</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/architecture/overview">æ¦‚è¿°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/architecture/resource-model">èµ„æºæ¨¡å‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/architecture/priority">ä¼˜å…ˆçº§</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/architecture/qos">QoS</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/zh-Hans/docs/user-manuals/colocation-profile">ç”¨æˆ·æ‰‹å†Œ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/zh-Hans/docs/designs/koordlet-overview">è®¾è®¡</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/koordlet-overview">Koordlet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/runtime-proxy">RuntimeProxy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/nri-mode-resource-management">NRI Mode Resource Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/node-prediction">Node Prediction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/enhanced-scheduler-extension">Enhanced Scheduler Extension</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/load-aware-scheduling">è´Ÿè½½æ„ŸçŸ¥è°ƒåº¦</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/fine-grained-cpu-orchestration">ç²¾ç»†åŒ– CPU ç¼–æ’</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/resource-reservation">Resource Reservation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/pod-migration-job">PodMigrationJob</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/descheduler-framework">Descheduler Framework</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/fine-grained-device-scheduling">Fine-grained device scheduling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-Hans/docs/designs/gang-scheduling">GangScheduling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/designs/multi-hierarchy-elastic-quota-management">Multi Hierarchy Elastic Quota Management</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/zh-Hans/docs/best-practices/colocation-of-spark-jobs">æœ€ä½³å®è·µ</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/zh-Hans/">ğŸ </a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">è®¾è®¡</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/zh-Hans/docs/designs/gang-scheduling">GangScheduling</a></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">ç‰ˆæœ¬ï¼šv1.3</span><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><h1>GangScheduling</h1><h2 class="anchor anchorWithStickyNavbar_mojV" id="æ¦‚è§ˆ">æ¦‚è§ˆ<a class="hash-link" href="#æ¦‚è§ˆ" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>Koord-dscheduler æä¾›äº† Gang Scheduling æ»¡è¶³ All-or-Nothing è°ƒåº¦éœ€æ±‚ã€‚ç”¨æˆ·å¯ä»¥å£°æ˜æœ€å°èµ„æºé›†åˆæ•°ï¼ˆresource-collection-minimumï¼‰ï¼Œåªæœ‰å½“å·²ç»å®Œæˆè°ƒåº¦èµ„æºæ•°ï¼ˆassigned-resourcesï¼‰è¶…è¿‡å‰é¢å£°æ˜å½“å‰æœ€å°èµ„æºé›†åˆæ•°æ‰èƒ½è§¦å‘èŠ‚ç‚¹ç»‘å®šã€‚
åŒæ—¶æä¾› <code>Strict</code> å’Œ <code>NonStrict</code> ä¸¤ä¸ªå‚æ•°ç”¨äºæ§åˆ¶ resource-accumulation-process ï¼ŒåŒºåˆ«äºå…¶ä»–ç¤¾åŒºæ–¹æ¡ˆå°†æä¾› two-level Gang æè¿°ç”¨äºæ›´å¥½åŒ¹é…çœŸå®åœºæ™¯ã€‚</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="åŠ¨æœº">åŠ¨æœº<a class="hash-link" href="#åŠ¨æœº" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>åœ¨ AI åœºæ™¯ä¸­å¾ˆå¤šä»»åŠ¡éƒ½éœ€è¦ä½¿ç”¨ Gang schedulingï¼Œç¤¾åŒºå·²ç»æœ‰å¾ˆå¤šç›¸å…³å®ç°ï¼Œæ¯”å¦‚ <code>Coscheduling</code> ã€ <code>Vocalno</code>ï¼Œè®¾è®¡è¿‡ç¨‹ä¸­æˆ‘ä»¬ä»ç¤¾åŒºé¡¹ç›®ä¸­å¾—åˆ°äº†å¾ˆå¤šçµæ„Ÿã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ç«å“å¯¹æ ‡">ç«å“å¯¹æ ‡<a class="hash-link" href="#ç«å“å¯¹æ ‡" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="coscheduling">Coscheduling<a class="hash-link" href="#coscheduling" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><ol><li><p><code>Coscheduling</code> ä¸»è¦é€šè¿‡å®ç°æ–°å‹é˜Ÿåˆ—æ’åºï¼ˆqueue-sortï¼‰æ¥å£ä»¥åŠå…¶ä»–æ–¹æ³•å°†ä¸€ç»„ Gang pod å°½é‡æœ‰åºçš„å‡ºé˜Ÿã€‚
ä¸¾ä¸ªğŸŒ° ï¼Œæˆ‘ä»¬æœ‰ 10 ä¸ªä»»åŠ¡éœ€è¦è¿›è¡Œ Gang è°ƒåº¦ï¼Œå‰é¢ 5 ä¸ªä»»åŠ¡å·²ç»è°ƒåº¦æˆåŠŸï¼Œæ­¤æ—¶ç¬¬ 6 ä¸ªä»»åŠ¡è°ƒåº¦å¤±è´¥ï¼Œ<code>Coscheduling</code> å°†ä¼šå›æ»šå‰é¢ 5 ä¸ªå·²ç»å®Œæˆè°ƒåº¦çš„ä»»åŠ¡ï¼ŒåŒæ—¶ä¼šè·³è¿‡åé¢ 4 ä¸ªå¾…è°ƒåº¦ä¸­çš„ä»»åŠ¡ã€‚</p></li><li><p><code>Coscheduling</code> ä¼šç®€å•å¾—ä½¿ç”¨ä¸€ä¸ªå…¨å±€é—´éš”æ—¶é—´ä½œä¸º Gang è°ƒåº¦å‘¨æœŸã€‚è¯¥è®¾è®¡ä¼šå¸¦æ¥ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>é—®é¢˜ä¸€ï¼Œå¦‚æœé…ç½®é—´éš”å¤ªé•¿ä¼šå¸¦æ¥æ— æ•ˆç­‰å¾…ï¼Œå¦‚æœå¤ªçŸ­ä¼šå¸¦æ¥æ— æ•ˆè°ƒåº¦ã€‚</li><li>é—®é¢˜äºŒï¼Œå¦‚æœå¾…è°ƒåº¦åˆ†ç»„ä»»åŠ¡å¾ˆå¤šï¼Œæ­¤æ—¶å¤§æ¦‚ç‡ä¼šå‡ºç°å‘¨æœŸå†…æ— æ³•å®Œæˆè°ƒåº¦ï¼Œå‡ºç°è°ƒåº¦è¶…æ—¶çš„æƒ…å†µã€‚ </li></ol><p>å¯¹äºä¸Šé¢çš„åœºæ™¯ï¼Œæˆ‘ä»¬çš„è®¾è®¡ä¸­ç§°ä¸º <code>Strict</code>ï¼Œæ­¤åœºæ™¯ä¸‹è°ƒåº¦ä¼šä¸¥æ ¼æŒ‰ç…§æ—¢å®šé…ç½®çš„å‘¨æœŸæ—¶é—´è¿›è¡Œå·¥ä½œã€‚</p></li><li><p>æœ‰äº›ä»»åŠ¡éœ€è¦å¤æ‚çš„ Gang è¦æ±‚ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªä»»åŠ¡æœ‰å‡ ä¸ªè§„åˆ™ï¼Œæ¯ä¸ªè§„åˆ™éƒ½æœ‰å‡ ä¸ª pod ä»¥åŠè‡ªèº«çš„ Gang æ¡ä»¶ï¼Œä»»åŠ¡ä¹Ÿéœ€è¦ä¸åŒçš„è§„åˆ™æ¥ç»„æˆä¸åŒçš„ GangGroupsã€‚
ä¸€ä¸ª GangGroup ä¸­çš„æ‰€æœ‰ pod åªæœ‰åœ¨ GangGroup ä¸­çš„æ‰€æœ‰è§„åˆ™éƒ½æ»¡è¶³ Gang æ¡ä»¶åæ‰è§¦å‘ç»‘å®šè¿‡ç¨‹ã€‚ä¸Šæ¸¸æ ‡å‡†çš„ <code>Coscheduling</code> ä¸èƒ½æ»¡è¶³è¿™ä¸ªéœ€æ±‚ã€‚</p></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="ç›®æ ‡">ç›®æ ‡<a class="hash-link" href="#ç›®æ ‡" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ol><li><p>å®šä¹‰ Gang è°ƒåº¦é…ç½®ã€‚</p></li><li><p>æä¾›è°ƒåº¦å™¨æ’ä»¶å®ç° Gang è°ƒåº¦ã€‚</p></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="éç›®æ ‡æœªæ¥å·¥ä½œ">éç›®æ ‡/æœªæ¥å·¥ä½œ<a class="hash-link" href="#éç›®æ ‡æœªæ¥å·¥ä½œ" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ol><li>æä¾›ä½¿ç”¨ <code>NonStrict</code> è§£å†³ Gang èµ„æºæ­»é”é—®é¢˜çš„èƒ½åŠ›ã€‚</li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="æ–¹æ¡ˆ">æ–¹æ¡ˆ<a class="hash-link" href="#æ–¹æ¡ˆ" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="æ ¸å¿ƒæ¦‚å¿µ">æ ¸å¿ƒæ¦‚å¿µ<a class="hash-link" href="#æ ¸å¿ƒæ¦‚å¿µ" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="strict--nonstrict">Strict / NonStrict<a class="hash-link" href="#strict--nonstrict" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p><code>Strict</code> æ¨¡å¼ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ª pod è°ƒåº¦å¤±è´¥ï¼Œå½“å‰è°ƒåº¦å‘¨æœŸå†…ï¼Œå…¶ä»–å·²ç»è°ƒåº¦æˆåŠŸçš„ pod å°†ä¼šè¢«å–æ¶ˆè°ƒåº¦ï¼ŒåŒæ—¶æ­£åœ¨è°ƒåº¦ä¸­çš„ pod å°†ä¼šåœ¨ PreFilter é˜¶æ®µè¢«æ‹’ç»è°ƒåº¦ã€‚</p><p><code>NonStrict</code> æ¨¡å¼ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ª pod è°ƒåº¦å¤±è´¥ï¼Œå¹¶ä¸ä¼šå½±å“å…¶ä»– pod å‚ä¸è°ƒåº¦ï¼Œä¼šç»§ç»­ç´¯è®¡å·²ç»è¢«è°ƒåº¦çš„ pod ç›´åˆ°ç¬¦åˆ Gang è°ƒåº¦æ¡ä»¶ã€‚æ­¤æ¨¡å¼å¯¹äº pod æ¯”è¾ƒå¤šçš„æƒ…å†µæ¯”è¾ƒå‹å¥½ï¼Œä½†æ˜¯ä¼šå¢åŠ ä¸åŒ Gang è°ƒåº¦ä¹‹é—´èµ„æºæ­»é”çš„é£é™©ã€‚</p><blockquote><p>ä¸¾ä¸ªğŸŒ° ï¼Œå¦‚æœå½“å‰èµ„æºé…é¢ä¸º 10ï¼Œæ­¤æ—¶ç”¨æˆ·æäº¤ä¸‰ç»„ Gang è°ƒåº¦ä»»åŠ¡ pod æ•°éƒ½ä¸º 5ï¼Œç”±äºå„ç§æ¡ä»¶é™åˆ¶ï¼ŒGang è°ƒåº¦ 1/2/3 ä»»åŠ¡åˆ†åˆ«è°ƒåº¦èµ·æ¥ pod æ•°é‡ä¸º 3/3/4ï¼Œ
æ­¤æ—¶å½“å‰èµ„æºç»„é…é¢å·²ç»è€—å°½ï¼Œä¸ä¼šæœ‰æ–°çš„ pod å®Œæˆè°ƒåº¦ï¼Œä¸‰ç»„ Gang è°ƒåº¦ä»»åŠ¡å°±ä¼šä¸€ç›´å‡ºäºç­‰å¾…çŠ¶æ€ï¼Œè¿™å°±æ˜¯ä¸Šé¢è¯´åˆ°åˆ°èµ„æºæ­»é”æƒ…å†µï¼Œç›®å‰è¿˜æ²¡æœ‰è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p></blockquote><h4 class="anchor anchorWithStickyNavbar_mojV" id="ganggroup">GangGroup<a class="hash-link" href="#ganggroup" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p><code>GangGroup</code>ï¼Œæœ‰äº›ä»»åŠ¡éœ€è¦å¤æ‚çš„ Gang è¦æ±‚ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªä»»åŠ¡æœ‰å‡ ä¸ªè§„åˆ™ï¼Œæ¯ä¸ªè§„åˆ™éƒ½æœ‰å‡ ä¸ª pod ä»¥åŠè‡ªèº«çš„ Gang æ¡ä»¶ï¼Œä»»åŠ¡ä¹Ÿéœ€è¦ä¸åŒçš„è§„åˆ™æ¥ç»„æˆä¸åŒçš„ GangGroupsã€‚
ä¸€ä¸ª GangGroup ä¸­çš„æ‰€æœ‰ pod åªæœ‰åœ¨ GangGroup ä¸­çš„æ‰€æœ‰è§„åˆ™éƒ½æ»¡è¶³ Gang æ¡ä»¶åæ‰è§¦å‘ç»‘å®šè¿‡ç¨‹ã€‚<code>GangGroup</code> åˆ™å…è®¸æˆ‘ä»¬å°†ä¸åŒ Gangs è¿›è¡Œèšåˆã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="after-gang">After Gang<a class="hash-link" href="#after-gang" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>æ³¨æ„âš ï¸ï¼Œå¦‚æœæ»¡è¶³ Gang è°ƒåº¦èµ„æºç§¯ç´¯æ¡ä»¶ï¼Œéšåä¸€äº› pod åœ¨ binding é˜¶æ®µå¤±è´¥ï¼Œæˆ–è€…ä¸€äº›å·²ç»ç»‘å®šçš„ pod è¢«æŠ¢å æˆ–è€…é‡æ–°è°ƒåº¦ï¼Œè¿™ç§æƒ…å†µä¸‹ Gang çš„çº¦æŸåœ¨èµ„æºé‡æ–°åˆ†é…è¿‡ç¨‹ä¸­æ˜¯å¦ä¾ç„¶æœ‰æ•ˆï¼Ÿ</p><p>ç­”æ¡ˆï¼šåº”è¯¥æœ‰æ•ˆã€‚å› ä¸º Gang çš„è®¾è®¡åˆè¡·è¦æ±‚æ‰€æœ‰ pod éœ€è¦åŒæ—¶è¢«æ‹‰èµ·ï¼Œå¦‚æœåªæœ‰å…¶ä¸­ä¸€äº› pod è¢«æ‹‰èµ·ï¼Œé‚£ä¹ˆåç»­æ“ä½œç»§ç»­æ‰§è¡Œ Gang è°ƒåº¦ç­–ç•¥å°†å¤±å»æ„ä¹‰ã€‚å› æ­¤ï¼Œä¸€æ—¦ Gang ç­–ç•¥å·²ç»æ»¡è¶³ï¼Œåç»­æ‰€æœ‰çš„èµ„æºåˆ†é…å°†ä¸å— Gang è§„åˆ™çº¦æŸï¼Œåç»­å°†ä½¿ç”¨é»˜è®¤è°ƒåº¦è¿›è¡Œ pod è°ƒåº¦ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="waittime">WaitTime<a class="hash-link" href="#waittime" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p><code>WaitTime</code> è‡ªç¬¬ä¸€ä¸ª pod è¿›å…¥ permit é˜¶æ®µä¾èµ–çš„æœ€å¤§ç­‰å¾…æ—¶é—´ã€‚å¦‚æœ <code>WaitTime</code> å·²ç»è¶…æ—¶ï¼Œè°ƒåº¦å™¨å°†ä¼šå›æ»šæ‰€æœ‰å·²ç»è°ƒåº¦å®Œæˆçš„ podï¼Œå¹¶ä¸”æ›´æ–°æ‰€æœ‰ pod annotation <code>gang.scheduling.koordinator.sh/timeout=true</code>ï¼Œè°ƒåº¦å™¨å°†ä¸ä¼šå†è°ƒåº¦è¿™äº› podã€‚ç”¨æˆ·éœ€è¦æ³¨æ„è¿™ç§æƒ…å†µå¹¶åŠæ—¶åˆ é™¤æ­¤ç±» podã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="api">API<a class="hash-link" href="#api" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="å®šä¹‰">å®šä¹‰<a class="hash-link" href="#å®šä¹‰" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>æˆ‘ä»¬è®¾è®¡çš„åˆè¡·æ˜¯ä¼˜åŒ–ä»¥åŠå¢å¼ºç¤¾åŒºåŸæœ‰çš„ <code>PodGroup</code> èƒ½åŠ›ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ <code>PodGroup</code> å®šä¹‰ä¼šå…¼å®¹ç¤¾åŒºè®¾è®¡ã€‚æˆ‘ä»¬ä¼šæä¾›é€šè¿‡ä½¿ç”¨æ›´æ–° annotation æ–¹å¼ä½¿ç”¨ Gang è°ƒåº¦ç‰¹æ€§ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="crd-æ–¹å¼">CRD æ–¹å¼<a class="hash-link" href="#crd-æ–¹å¼" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>ç”¨æˆ·å¯ä»¥ä½¿ç”¨ç¤¾åŒº <code>PodGroup</code> CRD å£°æ˜ Gangï¼š</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> PodGroup </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TypeMeta </span><span class="token string" style="color:#e3116c">`json:&quot;,inline&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metav1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ObjectMeta </span><span class="token string" style="color:#e3116c">`json:&quot;metadata,omitempty&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Spec PodGroupSpec </span><span class="token string" style="color:#e3116c">`json:&quot;spec,omitempty&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status PodGroupStatus </span><span class="token string" style="color:#e3116c">`json:&quot;status,omitempty&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> PodGroupSpec </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MinMember </span><span class="token builtin">int32</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;minMember,omitempty&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MinResources </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ResourceList </span><span class="token string" style="color:#e3116c">`json:&quot;minResources,omitempty&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ScheduleTimeoutSeconds </span><span class="token operator" style="color:#393A34">*</span><span class="token builtin">int32</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:&quot;scheduleTimeoutSeconds,omitempty&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><p>Pod éœ€è¦æ·»åŠ  label <code>pod-group.scheduling.sigs.k8s.io</code> æ¥å…³è” <code>PodGroup</code> é…ç½®ã€‚</p><p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å¯é€‰é…ç½®ï¼š</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gang.scheduling.koordinator.sh/total</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gang.scheduling.koordinator.sh/mode        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gang.scheduling.koordinator.sh/groups</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><ul><li><p><code>gang.scheduling.koordinator.sh/name</code> é…ç½® Gang è°ƒåº¦å™¨åç§°, åç§°éœ€è¦ç¬¦åˆ RFC 1123 è§„èŒƒã€‚</p></li><li><p><code>gang.scheduling.koordinator.sh/total-number</code> å½“å‰é…ç½®ä»…ä½œç”¨äº <code>Strict</code> æ¨¡å¼ï¼Œ è¯¦æƒ…è¯·å‚è€ƒ <code>Data-Structure</code> éƒ¨åˆ†ã€‚é»˜è®¤ä¸ <code>gang.scheduling.koordinator.sh/min-available</code> ä¸€è‡´ã€‚</p></li><li><p><code>gang.scheduling.koordinator.sh/mode</code> é€‰é¡¹ <code>Strict</code> æˆ–è€… <code>NonStrict</code>ã€‚ é»˜è®¤é…ç½®ä¸º <code>Strict</code>ã€‚</p></li><li><p><code>gang.scheduling.koordinator.sh/groups</code> ç”¨äºé…ç½® GangGroups åç§°ã€‚é»˜è®¤ä¸ºç©ºï¼Œè¡¨ç¤ºä¸éœ€è¦ä¸å…¶ä»–èµ„æºåˆå¹¶åˆ° GangGroupsï¼ŒåŒä¸€ä¸ª GangGroups çš„ Gangs å¯ä»¥æ¥è‡ªäºä¸åŒçš„ namespaceã€‚</p></li></ul><p><code>PodGroup</code> annotation å¯ä»¥åŒ…å« <code>gang.scheduling.koordinator.sh/total-number</code>ï¼Œ <code>gang.scheduling.koordinator.sh/mode</code>ï¼Œ <code>gang.scheduling.koordinator.sh/gang-groups</code>ã€‚</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ç¤ºä¾‹">ç¤ºä¾‹<a class="hash-link" href="#ç¤ºä¾‹" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>åŸºç¡€ Gang è°ƒåº¦é…ç½®å¦‚ä¸‹:</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PodGroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">creationTimestamp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2022-07-11T18:26:33Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gang</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">minMember</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">minResources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2048Mi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">scheduleTimeoutSeconds</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><p>åˆ›å»ºä¸€ä¸ªä»»åŠ¡åŒ…å«ä¸¤ä¸ªç­–ç•¥ï¼šA å’Œ Bï¼Œæ¯ä¸ªç­–ç•¥åŒ…å«ä¸€äº› podã€‚PodA å±äº roleAï¼ŒPodB å±äº roleBã€‚roleAã€roleB å½’å±äºåŒä¸€ä¸ª GangGroupï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PodGroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">creationTimestamp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2022-07-11T18:26:33Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gang</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> namespaceA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/total-number</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Strict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/groups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;namespaceA/gang-a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;namespaceB/gang-b&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">minMember</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">minResources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2048Mi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">scheduleTimeoutSeconds</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><p>æ³¨æ„ï¼šå¦‚æœç”¨æˆ·ä½¿ç”¨ <code>CRD way</code>ï¼Œéœ€è¦é›†ç¾¤ç®¡ç†å‘˜æå‰å°† PodGroup ç­–ç•¥éƒ¨ç½²åˆ°é›†ç¾¤ï¼Œå¦åˆ™ä¼šå‡ºç°å¸¦æœ‰ Gang é…ç½®çš„ Pod è¿›è¡Œè°ƒåº¦æ—¶ï¼Œæ‰¾ä¸åˆ°å¯¹åº”çš„ Gang ç­–ç•¥ PodGroup é…ç½®ã€‚
æ­¤å¤–ï¼Œä»è°ƒåº¦çš„è§’åº¦æ¥çœ‹ï¼Œè°ƒåº¦åº”è¯¥å¤„ç† Gang CRD å’Œ Pod ä¹‹é—´çš„ä»»åŠ¡é¡ºåºé—®é¢˜ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœ Pod åœ¨ Gang CRD ä¹‹å‰åˆ°è¾¾è°ƒåº¦ï¼Œæˆ‘ä»¬å¿…é¡»æ„å»ºä¸€ä¸ªå‡ Gang æ•°æ®ç»“æ„
ä¸´æ—¶æ”¶é›†æ‰€æœ‰ç›¸å…³çš„ Podï¼Œéœ€è¦æš‚åœ Pod çš„è°ƒåº¦ï¼Œç›´åˆ°ä»çœŸæ­£çš„ Gang CRD è§£æé…ç½®ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="annotation-æ–¹å¼">Annotation æ–¹å¼<a class="hash-link" href="#annotation-æ–¹å¼" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gang.scheduling.koordinator.sh/name           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gang.scheduling.koordinator.sh/min</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">available</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><p>ä»¥ä¸Šé…ç½®ä¸ºå¿…å¡«ï¼ŒåŒæ—¶æˆ‘ä»¬å…¼å®¹ç¤¾åŒº annotation <code>pod-group.scheduling.sigs.k8s.io</code>ï¼Œ <code>pod-group.scheduling.sigs.k8s.io/name</code>ä»¥åŠ <code>pod-group.scheduling.sigs.k8s.io/min-available</code> ã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜æ”¯æŒä»¥ä¸‹å¯é€‰é…ç½®ï¼š</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gang.scheduling.koordinator.sh/waiting</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gang.scheduling.koordinator.sh/total</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gang.scheduling.koordinator.sh/mode        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gang.scheduling.koordinator.sh/groups</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><ul><li><p><code>gang.scheduling.koordinator.sh/waiting-time</code> è‡ªç¬¬ä¸€ä¸ª pod è¿›å…¥ permit é˜¶æ®µä¾èµ–çš„æœ€å¤§ç­‰å¾…æ—¶é—´ã€‚é»˜è®¤å€¼å¯ä»¥åœ¨å…¨å±€é…ç½®ä¸­è®¾ç½®ã€‚</p></li><li><p><code>gang.scheduling.koordinator.sh/total-number</code> å½“å‰é…ç½®ä»…ä½œç”¨äº <code>Strict</code> æ¨¡å¼ï¼Œ è¯¦æƒ…è¯·å‚è€ƒ <code>Data-Structure</code> éƒ¨åˆ†ã€‚é»˜è®¤ä¸ <code>gang.scheduling.koordinator.sh/min-available</code> ä¸€è‡´ã€‚</p></li><li><p><code>gang.scheduling.koordinator.sh/mode</code> é€‰é¡¹ <code>Strict</code> æˆ–è€… <code>NonStrict</code>ã€‚ é»˜è®¤é…ç½®ä¸º <code>Strict</code>ã€‚</p></li><li><p><code>gang.scheduling.koordinator.sh/groups</code> ç”¨äºé…ç½® GangGroups åç§°ã€‚é»˜è®¤ä¸ºç©ºï¼Œè¡¨ç¤ºä¸éœ€è¦ä¸å…¶ä»–èµ„æºåˆå¹¶åˆ° GangGroupsï¼ŒåŒä¸€ä¸ª GangGroups çš„ Gangs å¯ä»¥æ¥è‡ªäºä¸åŒçš„ namespaceã€‚</p></li></ul><p>æ³¨æ„âš ï¸ï¼Œå¦‚æœåŒæ—¶é€šè¿‡ CRD å’Œ annotation æ–¹å¼è¿›è¡Œé…ç½®ï¼Œè¯¥ annotation é…ç½®å°†ä¼šè¦†ç›– CRD é…ç½®ã€‚åŒæ—¶ï¼Œ GangGroup åç§°æ ¼å¼ä¸º &quot; gangNamespace&quot; + &quot;/&quot; + &quot;gangName &quot;</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ç¤ºä¾‹-1">ç¤ºä¾‹<a class="hash-link" href="#ç¤ºä¾‹-1" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>åŸºç¡€ Gang è°ƒåº¦é…ç½®å¦‚ä¸‹:</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gang</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/min-available</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><p>åˆ›å»ºä¸€ä¸ªä»»åŠ¡åŒ…å«ä¸¤ä¸ªç­–ç•¥ï¼šA å’Œ Bï¼Œæ¯ä¸ªç­–ç•¥åŒ…å«ä¸€äº› Podã€‚PodA å±äº roleAï¼ŒPodB å±äº roleBã€‚roleAã€roleB å½’å±äºåŒä¸€ä¸ª GangGroupï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gang</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/waiting-time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 3600s </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/min-available</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/total-number</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Strict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/groups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;namespaceA/gang-a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;namespaceB/gang-b&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gang</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/waiting-time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 3600s </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/min-available</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/total-number</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Strict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/groups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;namespaceA/gang-a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;namespaceB/gang-b&quot;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><p>åˆ›å»ºä¸€ä¸ªä»»åŠ¡åŒ…å«ä¸¤ä¸ªç­–ç•¥ï¼šA å’Œ Bï¼Œæ¯ä¸ªç­–ç•¥åŒ…å«ä¸€äº› Podã€‚PodA å±äº roleAï¼ŒPodB å±äº roleBã€‚roleAã€roleB å½’å±äºä¸åŒ GangGroupï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gang</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/waiting-time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 3600s </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/min-available</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/total-number</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Strict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/groups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gang</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/waiting-time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 3600s </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/min-available</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/total-number</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Strict</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">gang.scheduling.koordinator.sh/groups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="è¯¦ç»†è®¾è®¡">è¯¦ç»†è®¾è®¡<a class="hash-link" href="#è¯¦ç»†è®¾è®¡" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="queuesortplugin">QueueSortPlugin<a class="hash-link" href="#queuesortplugin" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>æˆ‘ä»¬å•ç‹¬è®¾è®¡è°ƒåº¦å™¨æ’ä»¶ç”¨äºå®ç° <code>QueueSort</code> æ‹“å±•ç‚¹ï¼Œè¿™æ ·å°±å¯ä»¥å°†é˜Ÿåˆ—æ’åºé€»è¾‘é›†æˆåˆ°æ‰€æœ‰æ’ä»¶ï¼Œå¹¶ä¸”åªéœ€è¦æ³¨å†Œä¸€æ¬¡ã€‚</p><p>å½“å‰æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬å®ç° Less æ–¹æ³•æ±‡æ€»å±äºç›¸åŒ Gang çš„ podã€‚å…·ä½“æ’åºè§„åˆ™ä¸ºï¼š</p><ol><li>æ¯”è¾ƒä¸¤ä¸ª pod çš„ä¼˜å…ˆçº§é…ç½®ï¼Œä¼˜å…ˆçº§è¶Šé«˜çš„ pod ä¼˜å…ˆå…¥é˜Ÿã€‚</li><li>æ¯”è¾ƒä¸¤ä¸ª pod çš„åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚æœ pod å½’å±äºåŒä¸€ä¸ª Gang é…ç½®ï¼Œæˆ‘ä»¬æ¯”è¾ƒ Gang é…ç½®åˆ›å»ºæ—¶é—´ï¼Œè°å…ˆåˆ›å»ºåˆ™ä¼˜å…ˆå…¥é˜Ÿã€‚</li><li>æ¯”è¾ƒ pod çš„ namespaceï¼Œå¦‚æœ pod å½’å±æŸä¸€ä¸ª Gang é…ç½®ï¼Œåˆ™æ¯”è¾ƒ Gang åç§°ã€‚</li></ol><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> QueueSortPlugin </span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">QueueSort</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">QueuedPodInfo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">QueuedPodInfo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="gangschedulingplugin">GangSchedulingPlugin<a class="hash-link" href="#gangschedulingplugin" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><h5 class="anchor anchorWithStickyNavbar_mojV" id="data-structure">Data-Structure<a class="hash-link" href="#data-structure" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><h6 class="anchor anchorWithStickyNavbar_mojV" id="gang">Gang<a class="hash-link" href="#gang" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h6><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Gang </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Name                         </span><span class="token builtin">string</span><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WaitTime                     time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Duration                       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Mode                         </span><span class="token builtin">string</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic">//Strict or NonStrict</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GangGroup                    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token plain">               </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MinRequiredNumber            </span><span class="token builtin">int</span><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TotalChildrenNum             </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Children                     </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">PodInfo  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BoundChildren                </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">PodInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WaitingForBindChildren       </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">PodInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ResourceSatisfied            </span><span class="token builtin">bool</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ScheduleCycle                </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ScheduleCycleValid           </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ChildrenScheduleRoundMap     </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><p>Gangï¼Œç”¨äºè®°å½• Gang è°ƒåº¦çŠ¶æ€åˆ°è°ƒåº¦å™¨ç¼“å­˜ã€‚</p><ul><li><code>Children</code>ï¼Œç”¨äºè®°å½•å½’å±äºå½“å‰ Gang çš„ pod åˆ—è¡¨ã€‚</li><li><code>BoundChildren</code>ï¼Œ<code>WaitingForBindChildren</code> ç”¨äºè®°å½•å·²ç»å‡ºäº binding çŠ¶æ€çš„ podï¼Œç”¨äºæ£€æŸ¥ pod æ˜¯å¦å·²ç»é€šè¿‡ permit é˜¶æ®µã€‚</li><li><code>ResourceSatisfied</code>ï¼Œç”¨äºæ ‡è®°å½“å‰ pod æ˜¯å¦é€šè¿‡è°ƒåº¦ Permit é˜¶æ®µï¼Œå¦‚æœé€šè¿‡åˆ™ä¸º trueã€‚è¯¥å­—æ®µä¸»è¦ç”¨äºåˆ¤æ–­å½“å‰ Gang è°ƒåº¦æ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚</li><li><code>scheduleCycle</code>ï¼Œ<code>childrenScheduleRoundMap</code>ï¼Œå‰é¢ä¸¤ä¸ªå­—æ®µä¸»è¦ç”¨äºæ§åˆ¶ Gang è°ƒåº¦å‘¨æœŸã€‚<blockquote><p>ä¸¾ä¸ªğŸŒ° ï¼Œè°ƒåº¦ä¼Šå§‹ <code>scheduleCycle</code> å­—æ®µä¸º 1ï¼Œ<code>childrenScheduleRoundMap</code> ä¸­æ‰€æœ‰ pod å€¼ä¸º 0ã€‚
æ‰€æœ‰ pod è¿›å…¥ PreFilter é˜¶æ®µæ—¶ï¼Œå°†ä¼šåˆ¤æ–­ <code>childrenScheduleRoundMap</code> ä¸­ pod å€¼æ˜¯å¦å°äº <code>scheduleCycle</code> å€¼ï¼›
å¦‚æœä¸Šä¸€æ­¥æ ¡éªŒé€šè¿‡ï¼Œåˆ™å°† <code>childrenScheduleRoundMap</code> å€¼è®¾ç½®ä¸º <code>scheduleCycle</code> çš„å€¼ï¼Œå¹¶é€šè¿‡å½“å‰æ ¡éªŒï¼›
åä¹‹åˆ™è¯´æ˜å½“å‰ pod åœ¨æœ¬è½®è°ƒåº¦å‘¨æœŸå†…å·²ç»å®Œæˆè°ƒåº¦ï¼Œéœ€è¦æ‹’ç»æœ¬æ¬¡è°ƒåº¦ã€‚
æ ¹æ® <code>totalChildrenNum</code> å­—æ®µï¼Œå½“æ‰€æœ‰ pod éƒ½é€šè¿‡ PreFilter é˜¶æ®µï¼Œè¯´æ˜å½“å‰è°ƒåº¦å‘¨æœŸæ‰€æœ‰ pod å·²ç»å®Œæˆè°ƒåº¦ï¼Œ<code>scheduleCycle</code> éœ€è¦ç´¯åŠ  1ï¼Œè¯´æ˜å¼€å¯æ–°ä¸€è½®è°ƒåº¦å‘¨æœŸã€‚</p></blockquote></li><li><code>scheduleCycleValid</code>ï¼Œå½“å‰ Gang ä¸­ä»»æ„ pod åœ¨ Filter é˜¶æ®µå¤±è´¥ï¼ŒscheduleCycleValid å°†è®¾ç½®ä¸º trueï¼Œåªæœ‰æ‰€æœ‰ pod å…¨éƒ¨é€šè¿‡ Filter é˜¶æ®µï¼Œè¯¥å­—æ®µæ‰ä¼šè®¾ç½®ä¸º trueã€‚
<code>scheduleCycleValid=false</code> æ­¤åœºæ™¯ä¸‹æ‰€æœ‰ pod å°†ä¸ä¼šè¿›è¡Œè°ƒåº¦ï¼ŒåŒæ—¶æ‰€æœ‰è°ƒåº¦ä¸­éƒ½ pod å°†è¢«åœ¨ PreFilter é˜¶æ®µè¢«æ‹’ç»ï¼Œå½“æ–°ä¸€è½®è°ƒåº¦å‘¨æœŸå¼€å¯æ—¶ï¼Œ<code>scheduleCycleValid</code> æ‰ä¼šè¢«è®¾ç½®ä¸º trueã€‚</li></ul><p>æ³¨æ„âš ï¸ ï¼Œ<code>scheduleCycle\scheduleCycleValid\childrenScheduleRoundMap</code> ä»…ä½œç”¨äº <code>Strict</code> æ¨¡å¼ã€‚</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="gangplugin">GangPlugin<a class="hash-link" href="#gangplugin" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>åœ¨è°ƒåº¦å™¨æ¡†æ¶ Plugin ç»“æ„æåŸºç¡€ä¸Šï¼Œå¢åŠ  gangCache ç”¨äºç¼“å­˜ Gang ä¿¡æ¯ã€‚</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> GangPlugin </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    frameworkHandler            framework</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Handle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gangClient                  gangClient</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    podLister                   listerv1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PodLister</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    snapshotSharedLister        framework</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SharedLister</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gangCache                   </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Gang</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><p>å½“å¯åŠ¨ kubernetes è°ƒåº¦å™¨æ—¶ï¼Œæˆ‘ä»¬ä»…éœ€è¦å°†æˆ‘ä»¬å½“é€»è¾‘æŒ‚è½½åˆ°ä»¥ä¸‹ 4 ä¸ªæ‰©å±•ç‚¹ï¼š</p><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> framework</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PreFilterPlugin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">GangScheduling</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> framework</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PostFilterPlugin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">GangScheduling</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> framework</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PermitPlugin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">GangScheduling</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> framework</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ReservePlugin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">Coscheduling</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> GangScheduling </span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">ActiveGang</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pod </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">corev1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">framework</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CycleState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">PreFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">corev1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">PostFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">CycleState</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pod </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> filteredNodeStatusMap NodeToStatusMap</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">PostFilterResult</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Status</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Permit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">corev1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">Unreserve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">framework</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CycleState</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pod </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pod</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nodeName </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_wuS7 clean-btn">å¤åˆ¶</button></div></div><h6 class="anchor anchorWithStickyNavbar_mojV" id="prefilter"><strong>PreFilter</strong><a class="hash-link" href="#prefilter" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h6><p><code>NonStrict</code> æ¨¡å¼ï¼Œæˆ‘ä»¬ä»…å¤„ç† æ­¥éª¤ä¸€å’ŒäºŒï¼š</p><ul><li><p>æ ¡éªŒ Gang ä¸‹åŒ…å«æ‰€æœ‰ pod æ˜¯å¦ç¬¦åˆæœ€å°æ•°ï¼Œå¦‚æœä¸ç¬¦åˆåˆ™æ‹’ç»å½“å‰ podã€‚</p></li><li><p>æ ¡éªŒ Gang æ˜¯å¦è¶…æ—¶ï¼Œå¦‚æœè¶…æ—¶åˆ™æ‹’ç»å½“å‰ podã€‚</p></li><li><p>æ ¡éªŒ Gang scheduleCycleValid å­—æ®µæ˜¯å¦ä¸º trueï¼Œå¦‚æœä¸º false åˆ™æ‹’ç»å½“å‰ podã€‚</p></li><li><p>å°è¯•æ›´æ–° <code>scheduleCycle</code>ï¼Œ <code>scheduleCycleValid</code>ï¼Œ <code>childrenScheduleRoundMap</code> å­—æ®µã€‚</p></li></ul><h6 class="anchor anchorWithStickyNavbar_mojV" id="postfilter"><strong>PostFilter</strong><a class="hash-link" href="#postfilter" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h6><p>åˆ°è¾¾å½“å‰é˜¶æ®µè¯´æ˜ pod æ²¡æœ‰é€šè¿‡ Filter æ ¡éªŒï¼Œæ“ä½œå¦‚ä¸‹ï¼š</p><ul><li><p>å¦‚æœ <code>Strict</code> æ¨¡å¼ï¼Œè®¾ç½® <code>scheduleCycleValid</code> å­—æ®µä¸º falseï¼ŒåŒæ—¶é‡Šæ”¾æ‰€æœ‰å·²ç»å®Œæˆè°ƒåº¦çš„ podã€‚</p></li><li><p>å¦‚æœ <code>NonStrict</code> æ¨¡å¼åˆ™ä¸åšä»»ä½•æ“ä½œã€‚</p></li></ul><h6 class="anchor anchorWithStickyNavbar_mojV" id="permit"><strong>Permit</strong><a class="hash-link" href="#permit" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h6><p>åˆ°è¾¾å½“å‰é˜¶æ®µè¯´æ˜ pod å·²ç»é€šè¿‡ Filter æ ¡éªŒï¼Œè°ƒåº¦å™¨æ’ä»¶å°†ä¼šè®¡ç®— GangGroup ä¸‹æ‰€æœ‰ Gang å·²ç»å®Œæˆè°ƒåº¦ pod æ•°é‡æ˜¯å¦æ»¡è¶³ Gang æœ€å°å€¼ã€‚</p><ul><li>å¦‚æœ Gang ä¸ç¬¦åˆ bind æ¡ä»¶ï¼Œæˆ‘ä»¬ä¼šå°† pod çŠ¶æ€ä¿®æ”¹ä¸º &quot;Wait&quot; å¹¶é…ç½®è¶…æ—¶æ—¶é—´ï¼ŒåŒæ—¶ bind åç¨‹ä¸€ç›´ä¿æŒç­‰å¾…ç›´åˆ°è¶…æ—¶æˆ–è€…é€šè¿‡æ ¡éªŒã€‚
éšåï¼Œæˆ‘ä»¬ä¼šæ‰§è¡Œ <code>ActiveGang</code> æ“ä½œï¼Œè¯¥æ“ä½œä¼šå°†å½’å±äº Gang çš„ pod ä» <code>schedulableQueue</code> æˆ–è€… <code>backoffQueue</code> é˜Ÿåˆ—ä¸­è¿ç§»åˆ° <code>activeQueue</code> é˜Ÿåˆ—ï¼Œ
å¦‚æ­¤æ“ä½œä¹‹åï¼Œpod å°†ä¼šè¢«å°½å¿«å°½äº«è°ƒåº¦ã€‚</li></ul><blockquote><p>æ³¨æ„âš ï¸ ï¼Œç¤¾åŒºè°ƒåº¦å™¨ä¸­ï¼Œè°ƒåº¦å‘¨æœŸæœ€é•¿ä¸èƒ½è¶…è¿‡ 15 åˆ†é’Ÿï¼Œæˆ‘ä»¬åˆ™éœ€è¦é€šè¿‡æ”¹å†™ RunPermitPlugins å°†è°ƒåº¦å‘¨æœŸé…ç½®è¶…è¿‡ 15 åˆ†é’Ÿã€‚</p></blockquote><ul><li>å¦‚æœ Gang ç¬¦åˆ bind æ¡ä»¶ï¼Œæˆ‘ä»¬å°†ç­‰å¾…ä¸­ pod çŠ¶æ€ä¿®æ”¹ä¸º &quot;Success&quot;ï¼Œæ­¤æ—¶ bind åç¨‹å°†ç»“æŸç­‰å¾…å¹¶æ‰§è¡Œåç»­æ“ä½œï¼Œå¹¶å°† Gang å¯¹è±¡ä¸­ <code>ResourceSatisfied</code> è®¾ç½®ä¸º trueã€‚</li></ul><h6 class="anchor anchorWithStickyNavbar_mojV" id="un-reserve"><strong>Un-reserve</strong><a class="hash-link" href="#un-reserve" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h6><p>å¦‚æœ permit é˜¶æ®µè¶…æ—¶ä¸” binding é˜¶æ®µå¤±è´¥ï¼Œæ­¤æ—¶è°ƒåº¦é˜¶æ®µå°†ä¼šæµè½¬åˆ° un-reserve é˜¶æ®µï¼Œæˆ‘ä»¬é€šè¿‡ Gang å¯¹è±¡ä¸­ <code>ResourceSatisfied</code> å€¼åˆ¤æ–­ï¼Œå¦‚æœæ­¤æ—¶å€¼ä¸º true è¯´æ˜ binding é˜¶æ®µå¤±è´¥ï¼Œåä¹‹åˆ™è¯´æ˜ Gang è¶…æ—¶ã€‚</p><ul><li><p>å¦‚æœ permit é˜¶æ®µè¶…æ—¶ï¼Œæˆ‘ä»¬å°†åœ¨æ‰€æœ‰ Gang ä¸‹æ‰€æœ‰ pod annotation ä¸­å¢åŠ  <code>gang.scheduling.koordinator.sh/timeout=true</code>ï¼ŒåŒæ—¶é‡Šæ”¾æ‰€æœ‰å·²ç»è°ƒåº¦æˆåŠŸçš„ podã€‚
æ­¤æ—¶ï¼ŒGang ä¸‹æ‰€æœ‰ pod å°†æ°¸è¿œä¸ä¼šå†è¿›è¡Œè°ƒåº¦ï¼Œç”¨æˆ·éœ€è¦æ‰‹åŠ¨å¤„ç† permit è¶…æ—¶é—®é¢˜ã€‚</p></li><li><p>å¦‚æœ binding é˜¶æ®µå¤±è´¥ï¼ŒGang èµ„æºç´¯è®¡æ“ä½œå°†ä¼šç»“æŸï¼Œéšåä¼šå›æ»šæ‰€æœ‰å¤±è´¥çš„ pod ã€‚</p></li></ul><h6 class="anchor anchorWithStickyNavbar_mojV" id="init"><strong>Init</strong><a class="hash-link" href="#init" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h6><p>æˆ‘ä»¬å°† watch pod äº‹ä»¶ï¼Œå¹¶æ ¹æ®äº‹ä»¶ç±»å‹æŒç»­æ›´æ–° Gangã€‚</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="æœªè§£é—®é¢˜">æœªè§£é—®é¢˜<a class="hash-link" href="#æœªè§£é—®é¢˜" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h2 class="anchor anchorWithStickyNavbar_mojV" id="å¯é€‰æ€§">å¯é€‰æ€§<a class="hash-link" href="#å¯é€‰æ€§" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>ç”¨æˆ·å¯ä»¥æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©ä½¿ç”¨ Gang <code>Strict</code> æˆ–è€… <code>NonStrict</code> æ¨¡å¼ã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/koordinator-sh/koordinator.sh/edit/main/docs/designs/gang-scheduling.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ç¼–è¾‘æ­¤é¡µ</a></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">æœ€å<!-- -->ç”± <b>saintube</b> <!-- -->äº <b><time datetime="2023-08-16T11:49:55.000Z">2023/8/16</time></b> <!-- -->æ›´æ–°</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡æ¡£åˆ†é¡µå¯¼èˆª"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh-Hans/docs/designs/fine-grained-device-scheduling"><div class="pagination-nav__sublabel">ä¸Šä¸€é¡µ</div><div class="pagination-nav__label">Fine-grained device scheduling</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh-Hans/docs/designs/multi-hierarchy-elastic-quota-management"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">Multi Hierarchy Elastic Quota Management</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#æ¦‚è§ˆ" class="table-of-contents__link toc-highlight">æ¦‚è§ˆ</a></li><li><a href="#åŠ¨æœº" class="table-of-contents__link toc-highlight">åŠ¨æœº</a><ul><li><a href="#ç«å“å¯¹æ ‡" class="table-of-contents__link toc-highlight">ç«å“å¯¹æ ‡</a></li><li><a href="#ç›®æ ‡" class="table-of-contents__link toc-highlight">ç›®æ ‡</a></li><li><a href="#éç›®æ ‡æœªæ¥å·¥ä½œ" class="table-of-contents__link toc-highlight">éç›®æ ‡/æœªæ¥å·¥ä½œ</a></li></ul></li><li><a href="#æ–¹æ¡ˆ" class="table-of-contents__link toc-highlight">æ–¹æ¡ˆ</a><ul><li><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="table-of-contents__link toc-highlight">æ ¸å¿ƒæ¦‚å¿µ</a></li><li><a href="#api" class="table-of-contents__link toc-highlight">API</a></li><li><a href="#è¯¦ç»†è®¾è®¡" class="table-of-contents__link toc-highlight">è¯¦ç»†è®¾è®¡</a></li></ul></li><li><a href="#æœªè§£é—®é¢˜" class="table-of-contents__link toc-highlight">æœªè§£é—®é¢˜</a></li><li><a href="#å¯é€‰æ€§" class="table-of-contents__link toc-highlight">å¯é€‰æ€§</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">æ–‡æ¡£</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zh-Hans/docs/designs/docs/installation">å¿«é€Ÿå¼€å§‹</a></li><li class="footer__item"><a class="footer__link-item" href="/zh-Hans/docs/designs/docs/user-manuals/colocation-profile">ç”¨æˆ·æ‰‹å†Œ</a></li><li class="footer__item"><a class="footer__link-item" href="/zh-Hans/docs/designs/docs/architecture/overview">æ¶æ„</a></li></ul></div><div class="col footer__col"><div class="footer__title">ç¤¾åŒº</div><ul class="footer__items"><li class="footer__item"><a href="https://join.slack.com/t/koordinator-sh/shared_invite/zt-1756qoub4-Cn4~esfdlfAPsD7cwO2NzA" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack ( #koordinator channel )<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/zh-Hans/docs/designs/">DingTalk (GroupID: 33383887)</a></li></ul></div><div class="col footer__col"><div class="footer__title">æ›´å¤š</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/koordinator-sh/koordinator" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/zh-Hans/docs/designs/blog">åšå®¢</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <br>
        <strong>Copyright Â© 2022 The Koordinator Authors. All rights reserved.</strong></div></div></div></footer></div>
<script src="/zh-Hans/assets/js/runtime~main.f1e42344.js"></script>
<script src="/zh-Hans/assets/js/main.6a11f22b.js"></script>
</body>
</html>