<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v1.7 plugin-docs plugin-id-default docs-doc-id-api-reference/webhook-endpoints">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Webhook Endpoints | Koordinator</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://koordinator.sh/zh-Hans/docs/api-reference/webhook-endpoints"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="v1.7"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v1.7"><meta data-rh="true" name="docsearch:version" content="v1.7"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v1.7"><meta data-rh="true" property="og:title" content="Webhook Endpoints | Koordinator"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/zh-Hans/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://koordinator.sh/zh-Hans/docs/api-reference/webhook-endpoints"><link data-rh="true" rel="alternate" href="https://koordinator.sh/docs/api-reference/webhook-endpoints" hreflang="en"><link data-rh="true" rel="alternate" href="https://koordinator.sh/zh-Hans/docs/api-reference/webhook-endpoints" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://koordinator.sh/docs/api-reference/webhook-endpoints" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://FKASWWQYOP-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/zh-Hans/blog/rss.xml" title="Koordinator RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-Hans/blog/atom.xml" title="Koordinator Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Koordinator" href="/zh-Hans/opensearch.xml"><link rel="stylesheet" href="/zh-Hans/assets/css/styles.d55f2266.css">
<link rel="preload" href="/zh-Hans/assets/js/runtime~main.004cc254.js" as="script">
<link rel="preload" href="/zh-Hans/assets/js/main.7c3c3fd8.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like Koordinator, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/koordinator-sh/koordinator">GitHub</a>! ⭐️</div><button type="button" aria-label="关闭" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-Hans/"><div class="navbar__logo"><img src="/zh-Hans/img/logo.svg" alt="Koordinator" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh-Hans/img/logo.svg" alt="Koordinator" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Koordinator</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-Hans/docs">文档</a><a class="navbar__item navbar__link" href="/zh-Hans/blog">博客</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/zh-Hans/docs/">v1.7</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-Hans/docs/next/api-reference/webhook-endpoints">v1.8 🚧</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh-Hans/docs/api-reference/webhook-endpoints">v1.7</a></li><li><a class="dropdown__link" href="/zh-Hans/docs/v1.6/">v1.6</a></li><li><a class="dropdown__link" href="/zh-Hans/docs/v1.5/">v1.5</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/docs/api-reference/webhook-endpoints" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh-Hans/docs/api-reference/webhook-endpoints" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://github.com/koordinator-sh/koordinator" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/zh-Hans/docs/">快速开始</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/">简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/installation">安装</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/zh-Hans/docs/architecture/overview">架构</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/architecture/overview">概述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/architecture/resource-model">资源模型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/architecture/priority">优先级</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/architecture/qos">QoS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/architecture/job">Job</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/architecture/device">Device</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-Hans/docs/user-manuals/gang-scheduling">用户手册</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-Hans/docs/designs/koordlet-overview">设计</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-Hans/docs/best-practices/batch-colocation-quick-start">最佳实践</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-Hans/docs/developer-guide/component-guide">Developer Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/zh-Hans/docs/api-reference/custom-resource-definitions">API Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/api-reference/custom-resource-definitions">Custom Resource Definitions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/api-reference/client-libraries">Client Libraries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/docs/api-reference/metrics-endpoints">Metrics Endpoints</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-Hans/docs/api-reference/webhook-endpoints">Webhook Endpoints</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh-Hans/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">API Reference</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Webhook Endpoints</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：v1.7</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>Webhook Endpoints</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>Koordinator implements Kubernetes admission webhooks to enforce custom policies during resource creation, update, and deletion. These webhooks are critical for ensuring proper resource management, quota enforcement, and system stability. The admission control system includes both mutating and validating webhooks for Pods, Nodes, ConfigMaps, ElasticQuota, and Reservations. This document details the endpoints, their configuration, admission logic, and operational considerations.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="webhook-registration">Webhook Registration<a href="#webhook-registration" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>Koordinator registers its admission webhooks through <code>MutatingWebhookConfiguration</code> and <code>ValidatingWebhookConfiguration</code> resources defined in <code>manifests.yaml</code>. These configurations specify the webhook server endpoint, rules for when webhooks are invoked, failure policies, and supported API versions.</p><p><strong>Webhook Registration Architecture:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MutatingWebhookConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── mutate-pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── mutate-node-status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── mutate-scheduling-sigs-k8s-io-v1alpha1-elasticquota</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  └── mutate-reservation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ValidatingWebhookConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── validate-pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── validate-node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── validate-scheduling-sigs-k8s-io-v1alpha1-elasticquota</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  └── validate-configmap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Webhook Server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├─→ MutatingWebhookConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  └─→ ValidatingWebhookConfiguration</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Diagram sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/config/webhook/manifests.yaml#L1-L199" target="_blank" rel="noopener noreferrer">manifests.yaml</a></li></ul><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/config/webhook/manifests.yaml#L1-L199" target="_blank" rel="noopener noreferrer">manifests.yaml</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mutating-webhooks">Mutating Webhooks<a href="#mutating-webhooks" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pod-mutating-webhook">Pod Mutating Webhook<a href="#pod-mutating-webhook" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>The Pod mutating webhook intercepts Pod creation and update operations to apply resource mutations based on colocation profiles and other scheduling policies. It ensures Pods are properly configured before admission to the cluster.</p><p><strong>API Path</strong>: <code>/mutate-pod</code><br>
<strong>HTTP Methods</strong>: POST<br>
<strong>Operations</strong>: CREATE, UPDATE<br>
<strong>Resource</strong>: pods.v1.core<br>
<strong>Failure Policy</strong>: Fail  </p><p>This webhook is registered with two separate rules for create and update operations, both using the same endpoint.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/pod/mutating/webhooks.go#L1-L54" target="_blank" rel="noopener noreferrer">webhooks.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/pod/mutating/mutating_handler.go" target="_blank" rel="noopener noreferrer">mutating_handler.go</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="node-status-mutating-webhook">Node Status Mutating Webhook<a href="#node-status-mutating-webhook" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>The Node status mutating webhook intercepts updates to Node status to apply resource amplification based on node colocation profiles. This allows Koordinator to enhance reported node resources based on observed capacity.</p><p><strong>API Path</strong>: <code>/mutate-node-status</code><br>
<strong>HTTP Methods</strong>: POST<br>
<strong>Operations</strong>: CREATE, UPDATE<br>
<strong>Resource</strong>: nodes/status.v1.core<br>
<strong>Failure Policy</strong>: Ignore  </p><p>The failure policy is set to &quot;Ignore&quot; to ensure node status updates are not blocked if the webhook is temporarily unavailable.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/node/mutating/webhooks.go#L1-L49" target="_blank" rel="noopener noreferrer">webhooks.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/node/mutating/mutating_handler.go" target="_blank" rel="noopener noreferrer">mutating_handler.go</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="elasticquota-mutating-webhook">ElasticQuota Mutating Webhook<a href="#elasticquota-mutating-webhook" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>The ElasticQuota mutating webhook intercepts ElasticQuota creation to ensure proper initialization and metadata setup. It validates and potentially modifies ElasticQuota specifications before persistence.</p><p><strong>API Path</strong>: <code>/mutate-scheduling-sigs-k8s-io-v1alpha1-elasticquota</code><br>
<strong>HTTP Methods</strong>: POST<br>
<strong>Operations</strong>: CREATE<br>
<strong>Resource</strong>: elasticquotas.v1alpha1.scheduling.sigs.k8s.io<br>
<strong>Failure Policy</strong>: Fail  </p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/elasticquota/mutating/webhooks.go#L1-L58" target="_blank" rel="noopener noreferrer">webhooks.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/elasticquota/quota_handler.go" target="_blank" rel="noopener noreferrer">quota_handler.go</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reservation-mutating-webhook">Reservation Mutating Webhook<a href="#reservation-mutating-webhook" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>The Reservation mutating webhook intercepts Reservation creation to apply default configurations and ensure proper setup based on cluster policies.</p><p><strong>API Path</strong>: <code>/mutate-reservation</code><br>
<strong>HTTP Methods</strong>: POST<br>
<strong>Operations</strong>: CREATE<br>
<strong>Resource</strong>: reservations.v1alpha1.scheduling.koordinator.sh<br>
<strong>Failure Policy</strong>: Fail  </p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/reservation/mutating/webhooks.go#L1-L52" target="_blank" rel="noopener noreferrer">webhooks.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/reservation/mutating/mutating_handler.go" target="_blank" rel="noopener noreferrer">mutating_handler.go</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="validating-webhooks">Validating Webhooks<a href="#validating-webhooks" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pod-validating-webhook">Pod Validating Webhook<a href="#pod-validating-webhook" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>The Pod validating webhook performs validation on Pod creation and update operations. It checks resource requests against quota limits, validates topology constraints, and ensures compliance with cluster policies.</p><p><strong>API Path</strong>: <code>/validate-pod</code><br>
<strong>HTTP Methods</strong>: POST<br>
<strong>Operations</strong>: CREATE, UPDATE<br>
<strong>Resource</strong>: pods.v1.core<br>
<strong>Failure Policy</strong>: Fail  </p><p>The validation includes checking if the Pod&#x27;s resource requests fit within available ElasticQuota and Reservation allocations.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/pod/validating/webhooks.go#L1-L58" target="_blank" rel="noopener noreferrer">webhooks.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/pod/validating/validating_handler.go" target="_blank" rel="noopener noreferrer">validating_handler.go</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="node-validating-webhook">Node Validating Webhook<a href="#node-validating-webhook" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>The Node validating webhook validates Node creation and update operations to ensure node resource amplification stays within configured limits.</p><p><strong>API Path</strong>: <code>/validate-node</code><br>
<strong>HTTP Methods</strong>: POST<br>
<strong>Operations</strong>: CREATE, UPDATE<br>
<strong>Resource</strong>: nodes.v1.core<br>
<strong>Failure Policy</strong>: Ignore  </p><p>Similar to the mutating counterpart, this uses an &quot;Ignore&quot; failure policy to prevent blocking critical node registration.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/node/validating/webhooks.go#L1-L49" target="_blank" rel="noopener noreferrer">webhooks.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/node/validating/validating_handler.go" target="_blank" rel="noopener noreferrer">validating_handler.go</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="elasticquota-validating-webhook">ElasticQuota Validating Webhook<a href="#elasticquota-validating-webhook" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>The ElasticQuota validating webhook validates ElasticQuota creation, update, and deletion operations to ensure quota topology rules are followed and no inconsistencies are introduced.</p><p><strong>API Path</strong>: <code>/validate-scheduling-sigs-k8s-io-v1alpha1-elasticquota</code><br>
<strong>HTTP Methods</strong>: POST<br>
<strong>Operations</strong>: CREATE, UPDATE, DELETE<br>
<strong>Resource</strong>: elasticquotas.v1alpha1.scheduling.sigs.k8s.io<br>
<strong>Failure Policy</strong>: Fail  </p><p>This webhook enforces hierarchical quota relationships and prevents invalid quota configurations.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/elasticquota/validating/webhooks.go#L1-L58" target="_blank" rel="noopener noreferrer">webhooks.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/elasticquota/quota_handler.go" target="_blank" rel="noopener noreferrer">quota_handler.go</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configmap-validating-webhook">ConfigMap Validating Webhook<a href="#configmap-validating-webhook" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>The ConfigMap validating webhook validates ConfigMap operations to ensure Koordinator configuration integrity, particularly for SLO (Service Level Objective) configurations.</p><p><strong>API Path</strong>: <code>/validate-configmap</code><br>
<strong>HTTP Methods</strong>: POST<br>
<strong>Operations</strong>: CREATE, UPDATE, DELETE<br>
<strong>Resource</strong>: configmaps.v1.core<br>
<strong>Failure Policy</strong>: Fail  </p><p>This prevents invalid configuration changes that could affect cluster-wide behavior.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/cm/validating/webhooks.go#L1-L49" target="_blank" rel="noopener noreferrer">webhooks.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/cm/validating/validating_handler.go" target="_blank" rel="noopener noreferrer">validating_handler.go</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="admission-logic">Admission Logic<a href="#admission-logic" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>The admission logic varies by webhook type and resource:</p><ul><li><strong>Pod Mutation</strong>: Applies resource adjustments based on colocation profiles, potentially modifying CPU and memory requests/limits according to defined policies.</li><li><strong>Node Status Mutation</strong>: Amplifies node resource capacity based on historical utilization and colocation profiles, allowing overcommitment when safe.</li><li><strong>ElasticQuota Validation</strong>: Enforces quota topology rules, ensuring child quotas do not exceed parent limits and that resource distribution follows defined constraints.</li><li><strong>Pod Validation</strong>: Evaluates Pod resource requests against available ElasticQuota and Reservation allocations, rejecting Pods that would exceed limits.</li><li><strong>Node Validation</strong>: Ensures node resource amplification factors remain within administrator-defined bounds.</li><li><strong>ConfigMap Validation</strong>: Validates SLO configuration integrity, preventing malformed or contradictory settings.</li></ul><p>The logic is implemented through handler chains that process AdmissionReview requests and return appropriate responses with allowed status and optional patches.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/pod/mutating/mutating_handler.go" target="_blank" rel="noopener noreferrer">pod_mutating_handler.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/pod/validating/validating_handler.go" target="_blank" rel="noopener noreferrer">pod_validating_handler.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/node/mutating/mutating_handler.go" target="_blank" rel="noopener noreferrer">node_mutating_handler.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/node/validating/validating_handler.go" target="_blank" rel="noopener noreferrer">node_validating_handler.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/elasticquota/quota_handler.go" target="_blank" rel="noopener noreferrer">quota_handler.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/cm/validating/validating_handler.go" target="_blank" rel="noopener noreferrer">configmap_validating_handler.go</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="request-and-response-format">Request and Response Format<a href="#request-and-response-format" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>All webhooks follow the standard Kubernetes AdmissionReview format:</p><p><strong>Request Format</strong>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;apiVersion&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;admission.k8s.io/v1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;kind&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AdmissionReview&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;request&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;uid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;kind&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;group&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;kind&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;resource&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;group&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;resource&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;requestKind&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;group&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;kind&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;requestResource&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;group&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;resource&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;namespace&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;operation&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;CREATE|UPDATE|DELETE&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;userInfo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;object&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;raw&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;base64 encoded resource&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;oldObject&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;raw&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;base64 encoded resource&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;options&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;raw&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;base64 encoded options&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Response Format</strong>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;apiVersion&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;admission.k8s.io/v1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;kind&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AdmissionReview&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;response&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;uid&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;allowed&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> boolean</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Success|Failure&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;patch&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;base64 encoded JSON patch&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;patchType&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;JSONPatch&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Mutating webhooks may include a JSON patch in the response to modify the resource, while validating webhooks only indicate whether the operation is allowed.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/server.go#L1-L162" target="_blank" rel="noopener noreferrer">server.go</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="failure-policies-and-timeout-configuration">Failure Policies and Timeout Configuration<a href="#failure-policies-and-timeout-configuration" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>Webhooks are configured with different failure policies based on criticality:</p><ul><li><strong>Fail</strong>: Critical webhooks (Pod, ElasticQuota, Reservation, ConfigMap) use &quot;Fail&quot; policy, rejecting the operation if the webhook endpoint is unreachable.</li><li><strong>Ignore</strong>: Node-related webhooks use &quot;Ignore&quot; policy to prevent blocking node registration or status updates during webhook outages.</li></ul><p>The webhook server is configured to listen on port 9443 with TLS certificates managed through Kubernetes secrets. The server includes health checking endpoints at <code>/healthz</code> to support liveness and readiness probes.</p><p>Timeouts are controlled by the Kubernetes API server, typically defaulting to 30 seconds. The webhook implementation includes internal timeout handling to ensure timely responses.</p><p><strong>Webhook Processing Flow:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Participants:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Kubernetes API Server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Koordinator Webhook</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- kubectl (Client)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flow:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. kubectl → Kubernetes API Server: Create Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Kubernetes API Server → Koordinator Webhook: AdmissionReview Request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Koordinator Webhook internal: Process Request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Koordinator Webhook → Kubernetes API Server: AdmissionReview Response</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. Kubernetes API Server → kubectl: Operation Result</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Diagram sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/server.go#L1-L162" target="_blank" rel="noopener noreferrer">server.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/config/webhook/manifests.yaml#L1-L199" target="_blank" rel="noopener noreferrer">manifests.yaml</a></li></ul><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/server.go#L1-L162" target="_blank" rel="noopener noreferrer">server.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/config/webhook/manifests.yaml#L1-L199" target="_blank" rel="noopener noreferrer">manifests.yaml</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-webhook-issues">Troubleshooting Webhook Issues<a href="#troubleshooting-webhook-issues" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>Common webhook issues and troubleshooting approaches:</p><p><strong>Certificate Management</strong>: Webhook certificates are automatically generated and rotated. Issues often stem from certificate expiration or mismatched SANs. Check the <code>webhook-tls</code> secret in the koordinator-system namespace.</p><p><strong>Network Connectivity</strong>: Ensure the webhook service is reachable from the API server. Verify service endpoints and network policies allow traffic on port 9443.</p><p><strong>Performance Considerations</strong>: High webhook latency can block API operations. Monitor webhook duration metrics and ensure the webhook server has adequate resources.</p><p><strong>Debugging Steps</strong>:</p><ol><li>Check webhook server logs for errors</li><li>Verify webhook configurations with <code>kubectl get mutatingwebhookconfiguration,validatingwebhookconfiguration</code></li><li>Test connectivity to the webhook service</li><li>Validate certificate validity</li><li>Monitor admission latency metrics</li></ol><p>The webhook server includes a debug API handler for diagnostic purposes.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/server.go#L1-L162" target="_blank" rel="noopener noreferrer">server.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/util/health" target="_blank" rel="noopener noreferrer">health</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/util/generator" target="_blank" rel="noopener noreferrer">generator</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-and-best-practices">Security and Best Practices<a href="#security-and-best-practices" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>Security considerations for Koordinator webhooks:</p><ul><li><strong>Least Privilege</strong>: Webhook service account has minimal required permissions</li><li><strong>TLS Encryption</strong>: All webhook communications use TLS with automatically managed certificates</li><li><strong>Input Validation</strong>: Thorough validation of all admission requests to prevent malicious input</li><li><strong>Rate Limiting</strong>: Protection against denial-of-service through excessive requests</li><li><strong>Audit Logging</strong>: All admission decisions are logged for security auditing</li></ul><p>Best practices include:</p><ul><li>Regularly monitoring webhook performance and error rates</li><li>Testing configuration changes in non-production environments</li><li>Maintaining backup configurations for quick recovery</li><li>Implementing proper alerting for webhook failures</li></ul><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/server.go#L1-L162" target="_blank" rel="noopener noreferrer">server.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/config/webhook/manifests.yaml#L1-L199" target="_blank" rel="noopener noreferrer">manifests.yaml</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/config/rbac" target="_blank" rel="noopener noreferrer">rbac</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="webhook-chaining">Webhook Chaining<a href="#webhook-chaining" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>Koordinator webhooks are designed to work with other admission controllers in the Kubernetes admission chain. The order of execution is determined by the webhook configuration order in the API server.</p><p>When chaining with other controllers:</p><ul><li>Koordinator webhooks should typically run after core Kubernetes validation</li><li>Conflicts with other quota or resource management controllers should be avoided</li><li>The failure policy settings help prevent cascading failures</li></ul><p>The webhook server supports multiple concurrent requests and is optimized for low latency to minimize impact on the overall admission process.</p><p><strong>Section sources</strong></p><ul><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/server.go#L1-L162" target="_blank" rel="noopener noreferrer">server.go</a></li><li><a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/util/framework" target="_blank" rel="noopener noreferrer">framework</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/koordinator-sh/koordinator.sh/edit/main/docs/api-reference/webhook-endpoints.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->由 <b>乔普</b> <!-- -->于 <b><time datetime="2025-10-31T03:46:30.000Z">2025年10月31日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh-Hans/docs/api-reference/metrics-endpoints"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Metrics Endpoints</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#webhook-registration" class="table-of-contents__link toc-highlight">Webhook Registration</a></li><li><a href="#mutating-webhooks" class="table-of-contents__link toc-highlight">Mutating Webhooks</a><ul><li><a href="#pod-mutating-webhook" class="table-of-contents__link toc-highlight">Pod Mutating Webhook</a></li><li><a href="#node-status-mutating-webhook" class="table-of-contents__link toc-highlight">Node Status Mutating Webhook</a></li><li><a href="#elasticquota-mutating-webhook" class="table-of-contents__link toc-highlight">ElasticQuota Mutating Webhook</a></li><li><a href="#reservation-mutating-webhook" class="table-of-contents__link toc-highlight">Reservation Mutating Webhook</a></li></ul></li><li><a href="#validating-webhooks" class="table-of-contents__link toc-highlight">Validating Webhooks</a><ul><li><a href="#pod-validating-webhook" class="table-of-contents__link toc-highlight">Pod Validating Webhook</a></li><li><a href="#node-validating-webhook" class="table-of-contents__link toc-highlight">Node Validating Webhook</a></li><li><a href="#elasticquota-validating-webhook" class="table-of-contents__link toc-highlight">ElasticQuota Validating Webhook</a></li><li><a href="#configmap-validating-webhook" class="table-of-contents__link toc-highlight">ConfigMap Validating Webhook</a></li></ul></li><li><a href="#admission-logic" class="table-of-contents__link toc-highlight">Admission Logic</a></li><li><a href="#request-and-response-format" class="table-of-contents__link toc-highlight">Request and Response Format</a></li><li><a href="#failure-policies-and-timeout-configuration" class="table-of-contents__link toc-highlight">Failure Policies and Timeout Configuration</a></li><li><a href="#troubleshooting-webhook-issues" class="table-of-contents__link toc-highlight">Troubleshooting Webhook Issues</a></li><li><a href="#security-and-best-practices" class="table-of-contents__link toc-highlight">Security and Best Practices</a></li><li><a href="#webhook-chaining" class="table-of-contents__link toc-highlight">Webhook Chaining</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh-Hans/docs/api-reference/docs/installation">快速开始</a></li><li class="footer__item"><a class="footer__link-item" href="/zh-Hans/docs/api-reference/docs/user-manuals/colocation-profile">用户手册</a></li><li class="footer__item"><a class="footer__link-item" href="/zh-Hans/docs/api-reference/docs/architecture/overview">架构</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/koordinator-sh/shared_invite/zt-1756qoub4-Cn4~esfdlfAPsD7cwO2NzA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack ( #koordinator channel )<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/zh-Hans/docs/api-reference/">DingTalk (GroupID: 33383887)</a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/koordinator-sh/koordinator" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/zh-Hans/docs/api-reference/blog">博客</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <div style="font-size: 18px">
        <br>
        <strong>Koordinator是 <a href="https://www.cncf.io/">Cloud Native Computing Foundation</a> 沙箱项目 </strong>
        <br>
        </div>
        <br>
        <img src="img/cncf-color.svg" alt="CNCF" width="auto" height="100px">
        <br>
        <div style="font-size: 14px">
        Linux基金会® (TLF) 已注册并使用商标。如需了解Linux基金会的商标列表，请访问<a href="https://www.linuxfoundation.org/trademark-usage/">商标使用</a>页面。
        <br>
        Copyright © 2024 Koordinator项目作者。保留所有权利。
        </div>
        </div></div></div></footer></div>
<script src="/zh-Hans/assets/js/runtime~main.004cc254.js"></script>
<script src="/zh-Hans/assets/js/main.7c3c3fd8.js"></script>
</body>
</html>