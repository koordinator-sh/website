"use strict";(self.webpackChunkkoordinator_sh=self.webpackChunkkoordinator_sh||[]).push([[9654],{3905:(n,e,o)=>{o.d(e,{Zo:()=>m,kt:()=>h});var r=o(67294);function a(n,e,o){return e in n?Object.defineProperty(n,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[e]=o,n}function i(n,e){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.push.apply(o,r)}return o}function t(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach((function(e){a(n,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}))}return n}function u(n,e){if(null==n)return{};var o,r,a=function(n,e){if(null==n)return{};var o,r,a={},i=Object.keys(n);for(r=0;r<i.length;r++)o=i[r],e.indexOf(o)>=0||(a[o]=n[o]);return a}(n,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(r=0;r<i.length;r++)o=i[r],e.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(n,o)&&(a[o]=n[o])}return a}var p=r.createContext({}),c=function(n){var e=r.useContext(p),o=e;return n&&(o="function"==typeof n?n(e):t(t({},e),n)),o},m=function(n){var e=c(n.components);return r.createElement(p.Provider,{value:e},n.children)},s="mdxType",l={inlineCode:"code",wrapper:function(n){var e=n.children;return r.createElement(r.Fragment,{},e)}},d=r.forwardRef((function(n,e){var o=n.components,a=n.mdxType,i=n.originalType,p=n.parentName,m=u(n,["components","mdxType","originalType","parentName"]),s=c(o),d=a,h=s["".concat(p,".").concat(d)]||s[d]||l[d]||i;return o?r.createElement(h,t(t({ref:e},m),{},{components:o})):r.createElement(h,t({ref:e},m))}));function h(n,e){var o=arguments,a=e&&e.mdxType;if("string"==typeof n||a){var i=o.length,t=new Array(i);t[0]=d;var u={};for(var p in e)hasOwnProperty.call(e,p)&&(u[p]=e[p]);u.originalType=n,u[s]="string"==typeof n?n:a,t[1]=u;for(var c=2;c<i;c++)t[c]=o[c];return r.createElement.apply(null,t)}return r.createElement.apply(null,o)}d.displayName="MDXCreateElement"},61341:(n,e,o)=>{o.r(e),o.d(e,{assets:()=>p,contentTitle:()=>t,default:()=>l,frontMatter:()=>i,metadata:()=>u,toc:()=>c});var r=o(87462),a=(o(67294),o(3905));const i={},t="\u8bbe\u5907\u8c03\u5ea6 - \u534e\u4e3a\u6607\u817e NPU",u={unversionedId:"user-manuals/device-scheduling-ascend-npu",id:"version-v1.7/user-manuals/device-scheduling-ascend-npu",title:"\u8bbe\u5907\u8c03\u5ea6 - \u534e\u4e3a\u6607\u817e NPU",description:"\u80cc\u666f",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/version-v1.7/user-manuals/device-scheduling-ascend-npu.md",sourceDirName:"user-manuals",slug:"/user-manuals/device-scheduling-ascend-npu",permalink:"/zh-Hans/docs/user-manuals/device-scheduling-ascend-npu",draft:!1,editUrl:"https://github.com/koordinator-sh/koordinator.sh/edit/main/docs/user-manuals/device-scheduling-ascend-npu.md",tags:[],version:"v1.7",lastUpdatedBy:"\u4e54\u666e",lastUpdatedAt:1761882390,formattedLastUpdatedAt:"2025\u5e7410\u670831\u65e5",frontMatter:{},sidebar:"docs",previous:{title:"GPU & RDMA Joint Allocation",permalink:"/zh-Hans/docs/user-manuals/gpu-and-rdma-joint-allocation"},next:{title:"\u8bbe\u5907\u8c03\u5ea6 - \u5bd2\u6b66\u7eaa MLU",permalink:"/zh-Hans/docs/user-manuals/device-scheduling-cambricon-mlu"}},p={},c=[{value:"\u80cc\u666f",id:"\u80cc\u666f",level:2},{value:"\u4f7f\u7528\u65b9\u6cd5",id:"\u4f7f\u7528\u65b9\u6cd5",level:2},{value:"\u524d\u7f6e\u6761\u4ef6",id:"\u524d\u7f6e\u6761\u4ef6",level:3},{value:"\u4f7f\u7528",id:"\u4f7f\u7528",level:3},{value:"\u6607\u817e\u5361\u865a\u62df\u89c4\u683c\u5217\u8868",id:"\u6607\u817e\u5361\u865a\u62df\u89c4\u683c\u5217\u8868",level:3}],m={toc:c},s="wrapper";function l(n){let{components:e,...o}=n;return(0,a.kt)(s,(0,r.Z)({},m,o,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u8bbe\u5907\u8c03\u5ea6---\u534e\u4e3a\u6607\u817e-npu"},"\u8bbe\u5907\u8c03\u5ea6 - \u534e\u4e3a\u6607\u817e NPU"),(0,a.kt)("h2",{id:"\u80cc\u666f"},"\u80cc\u666f"),(0,a.kt)("p",null,"\u5f53\u524d Koordinator \u652f\u6301\u6607\u817e\u5361\u5728 K8s \u7684\u4f7f\u7528\uff0c\u57fa\u4e8e koord-device-daemon \u548c koordlet \u7ec4\u4ef6\u4e0a\u62a5\u5f02\u6784 GPU \u8d44\u6e90\uff0c\u5c06\u5f02\u6784\u5361\u4fe1\u606f\u6c47\u603b\u5230 Device \u4e2d\u4f9b\u8c03\u5ea6\u5668\u8fdb\u884c\u62d3\u6251\u8c03\u5ea6\u3002\u5f53\u524d\u540c\u65f6\u652f\u6301\u6607\u817e\u7684\u865a\u62df\u5316\u6a21\u677f\u548c\u6574\u5361\u3002"),(0,a.kt)("h2",{id:"\u4f7f\u7528\u65b9\u6cd5"},"\u4f7f\u7528\u65b9\u6cd5"),(0,a.kt)("h3",{id:"\u524d\u7f6e\u6761\u4ef6"},"\u524d\u7f6e\u6761\u4ef6"),(0,a.kt)("p",null,"\u6607\u817e\u5361\u7684\u4f7f\u7528\u9700\u8981\u63d0\u524d\u5b89\u88c5\u914d\u7f6e\u5982\u4e0b\u7ec4\u4ef6"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6607\u817e Driver"),(0,a.kt)("li",{parentName:"ul"},"\u6607\u817e ",(0,a.kt)("a",{parentName:"li",href:"https://gitcode.com/Ascend/mind-cluster/releases"},"Ascend Docker Runtime")),(0,a.kt)("li",{parentName:"ul"},"\u6607\u817e ",(0,a.kt)("a",{parentName:"li",href:"https://gitcode.com/Ascend/mind-cluster/releases"},"Ascend Device Plugin (\u5f00\u542f\u865a\u62df\u5316\u53c2\u6570\u914d\u7f6e)"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:"\u542f\u52a8\u53c2\u6570","\u542f\u52a8\u53c2\u6570":!0},"args:\n  - --volcanoType=true\n  - --presetVirtualDevice=false\n  - --useAscendDocker=true\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Koordinator \u76f8\u5173\u7ec4\u4ef6(koordinator >= v1.7.0)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u9700\u8981\u5728 chart \u7684 ",(0,a.kt)("inlineCode",{parentName:"li"},"scheduler.featureGates")," \u53c2\u6570\u4e2d\u52a0\u5165 ",(0,a.kt)("inlineCode",{parentName:"li"},"DevicePluginAdaption=true")," \u4ee5\u542f\u7528\u8be5\u529f\u80fd\u6240\u9700\u7684\u7279\u6027\u95e8\u63a7")))),(0,a.kt)("h3",{id:"\u4f7f\u7528"},"\u4f7f\u7528"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u786e\u8ba4\u6607\u817e\u5361\u5df2\u6210\u529f\u88ab Device \u8bc6\u522b\uff0c \u793a\u4f8b\u5982\u4e0b\uff0c\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"li"},"kubectl get device <node-name> -o yaml")," \u67e5\u770b Device \u8d44\u6e90\u3002")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6ce8\u610f",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"node.koordinator.sh/gpu-vendor \u5bf9\u5e94\u7684\u6807\u7b7e\u503c\u4e3a huawei"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"scheduling.koordinator.sh/gpu-partitions")," \u7684\u5185\u5bb9\u8868\u793a\u8fd9\u4e2a\u8282\u70b9\u7684\u5361\u7f16\u53f7 0,1,2,3 \u4e3a\u4e00\u7ec4 partion , \u5f7c\u6b64\u4e4b\u95f4\u6709 HCCS \u7684\u4eb2\u548c\u6027\uff0c\u5361 1\uff0c2\uff0c3\uff0c4 \u4e3a\u53e6\u4e00\u7ec4 partition \uff0c\u591a\u5361\u8c03\u5ea6\u7684\u65f6\u5019\u9700\u8981\u9075\u5faa\u4eb2\u548c\u6027\u7684\u8981\u6c42, \u4e0d\u80fd\u8de8\u8d8a\u4e0d\u540c\u7684partition\uff0c\u5426\u5219\u4e0d\u540cpartition\u4e4b\u95f4\u7684\u5361\u65e0\u6cd5\u901a\u4fe1\u3002")))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: scheduling.koordinator.sh/v1alpha1\nkind: Device\nmetadata:\n  labels:\n    node.koordinator.sh/gpu-partition-policy: "Honor" # Enforce partition policy during scheduling.\n    node.koordinator.sh/gpu-model: Ascend-910B3 # Model of the Ascend card.\n    node.koordinator.sh/gpu-vendor: huawei # Vendor of the card.\n  annotations:\n    scheduling.koordinator.sh/gpu-partitions: |\n      {\n        "4": [\n                {\n                    "minors": [\n                       0,1,2,3  # Minor numbers of cards in this partition\n                    ],\n                    "gpuLinkType": "HCCS", # Indicate the type of inter-card link within the partition.\n                    "allocationScore": "1" # Indicate the overall allocation quality for the node after the partition has been assigned away.\n                }\n        ],\n        "4": [\n                {\n                    "minors": [\n                       4,5,6,7 \n                    ],\n                    "gpuLinkType": "HCCS",\n                    "allocationScore": "1"\n                }\n        ]\n      }\n  name: node-1\nspec:\n  devices:\n    - health: true\n      id: GPU-fd971b33-4891-fd2e-ed42-ce6adf324615 # The UUID of the Ascend card (mocked value).\n      minor: 0 # Every card has a unique minor number. Card 0.\n      resources:\n        huawei.com/npu-core: "20" # Number of aicore on the Ascend card.\n        huawei.com/npu-cpu: "7"  # Number of aicpu on the Ascend card.\n        huawei.com/npu-dvpp: "100" # There exists dvpp on the Ascend card.\n        koordinator.sh/gpu-memory: 64Gi # The total memory capacity of the Ascend card.\n        koordinator.sh/gpu-memory-ratio: "100" # The total memory capacity of the Ascend card in percentage.\n      topology:\n        busID: 0000:3b:00.0 # PCI bus ID.\n        nodeID: 0 # NUMA node ID.\n        pcieID: pci0000:3a # PCIe root ID.\n        socketID: -1\n      type: gpu\n      conditions:\n        - lastTransitionTime: "2025-04-25T10:00:00Z"\n          message: device is healthy\n          reason: DeviceHealthy\n          status: "True"\n          type: Healthy\n    - health: true\n      id: GPU-ab123c45-6789-d001-e234-f567890abcde\n      minor: 1 # Card 1.\n      resources:\n        huawei.com/npu-core: "20"\n        huawei.com/npu-cpu: "7"\n        huawei.com/npu-dvpp: "100"\n        koordinator.sh/gpu-memory: 64Gi\n        koordinator.sh/gpu-memory-ratio: "100"\n      topology:\n        busID: 0000:3b:00.1\n        nodeID: 1\n        pcieID: pci0000:3a\n        socketID: -1\n      type: gpu\n      conditions:\n        - lastTransitionTime: "2025-04-25T10:00:00Z"\n          message: device is healthy\n          reason: DeviceHealthy\n          status: "True"\n          type: Healthy\n    - health: true\n      id: GPU-bc234d56-7890-e112-f345-678901bcdefa\n      minor: 2\n      resources:\n        huawei.com/npu-core: "20"\n        huawei.com/npu-cpu: "7"\n        huawei.com/npu-dvpp: "100"\n        koordinator.sh/gpu-memory: 64Gi\n        koordinator.sh/gpu-memory-ratio: "100"\n      topology:\n        busID: 0000:3b:00.2\n        nodeID: 2\n        pcieID: pci0000:3a\n        socketID: -1\n      type: gpu\n      conditions:\n        - lastTransitionTime: "2025-04-25T10:00:00Z"\n          message: device is healthy\n          reason: DeviceHealthy\n          status: "True"\n          type: Healthy\n    - health: true\n      id: GPU-cd345e67-8901-f223-4567-890123cdefab\n      minor: 3\n      resources:\n        huawei.com/npu-core: "20"\n        huawei.com/npu-cpu: "7"\n        huawei.com/npu-dvpp: "100"\n        koordinator.sh/gpu-memory: 64Gi\n        koordinator.sh/gpu-memory-ratio: "100"\n      topology:\n        busID: 0000:3b:00.3\n        nodeID: 3\n        pcieID: pci0000:3a\n        socketID: -1\n      type: gpu\n      conditions:\n        - lastTransitionTime: "2025-04-25T10:00:00Z"\n          message: device is healthy\n          reason: DeviceHealthy\n          status: "True"\n          type: Healthy\n    - health: true\n      id: GPU-de456f78-9012-f334-5678-901234defabc\n      minor: 4\n      resources:\n        huawei.com/npu-core: "20"\n        huawei.com/npu-cpu: "7"\n        huawei.com/npu-dvpp: "100"\n        koordinator.sh/gpu-memory: 64Gi\n        koordinator.sh/gpu-memory-ratio: "100"\n      topology:\n        busID: 0000:3b:00.4\n        nodeID: 4\n        pcieID: pci0000:3b\n        socketID: -1\n      type: gpu\n      conditions:\n        - lastTransitionTime: "2025-04-25T10:00:00Z"\n          message: device is healthy\n          reason: DeviceHealthy\n          status: "True"\n          type: Healthy\n    - health: true\n      id: GPU-ef567g89-0123-f445-6789-012345efabcd\n      minor: 5\n      resources:\n        huawei.com/npu-core: "20"\n        huawei.com/npu-cpu: "7"\n        huawei.com/npu-dvpp: "100"\n        koordinator.sh/gpu-memory: 64Gi\n        koordinator.sh/gpu-memory-ratio: "100"\n      topology:\n        busID: 0000:3b:00.5\n        nodeID: 5\n        pcieID: pci0000:3b\n        socketID: -1\n      type: gpu\n      conditions:\n        - lastTransitionTime: "2025-04-25T10:00:00Z"\n          message: device is healthy\n          reason: DeviceHealthy\n          status: "True"\n          type: Healthy\n    - health: true\n      id: GPU-fg678h90-1234-f556-7890-123456fgabce\n      minor: 6\n      resources:\n        huawei.com/npu-core: "20"\n        huawei.com/npu-cpu: "7"\n        huawei.com/npu-dvpp: "100"\n        koordinator.sh/gpu-memory: 64Gi\n        koordinator.sh/gpu-memory-ratio: "100"\n      topology:\n        busID: 0000:3b:00.6\n        nodeID: 6\n        pcieID: pci0000:3b\n        socketID: -1\n      type: gpu\n      conditions:\n        - lastTransitionTime: "2025-04-25T10:00:00Z"\n          message: device is healthy\n          reason: DeviceHealthy\n          status: "True"\n          type: Healthy\n    - health: true\n      id: GPU-gh789i01-2345-f667-8901-234567ghabcd\n      minor: 7\n      resources:\n        huawei.com/npu-core: "20"\n        huawei.com/npu-cpu: "7"\n        huawei.com/npu-dvpp: "100"\n        koordinator.sh/gpu-core: "100"\n        koordinator.sh/gpu-memory: 64Gi\n        koordinator.sh/gpu-memory-ratio: "100"\n      topology:\n        busID: 0000:3b:00.7\n        nodeID: 7\n        pcieID: pci0000:3b\n        socketID: -1\n      type: gpu\n      conditions:\n        - lastTransitionTime: "2025-04-25T10:00:00Z"\n          message: device is healthy\n          reason: DeviceHealthy\n          status: "True"\n          type: Healthy\nstatus: {}\n')),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"\u786e\u8ba4\u6607\u817e\u7684\u8282\u70b9\u4e0a\u5df2\u6b63\u786e\u6ce8\u518c\u6607\u817e\u5361\u8d44\u6e90\u4fe1\u606f\uff0c\u793a\u4f8b\u5982\u4e0b\uff0c\u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"li"},"kubectl get node <node-name> -o yaml")," \u67e5\u770b node.status.allocatable/node.status.capacity \u8d44\u6e90\u3002")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: v1\nkind: Node\nmetadata:\n  name: node-1\n  ...\nstatus:\n    allocatable:\n      ...\n      koordinator.sh/gpu.shared: "800" # Reported by koordinator\n      koordinator.sh/gpu-memory: 512Gi # Reported by koordinator\n      koordinator.sh/gpu-memory-ratio: "800" # Reported by koordinator\n      huawei.com/npu-core: "160" # Reported by ascend device plugin\n      huawei.com/npu-cpu: "56" # Reported by Koordinator\n      huawei.com/npu-dvpp: "800" #  Reported Koordinator\n    capacity:\n      ...\n      koordinator.sh/gpu.shared: "800" # Reported by koordinator\n      koordinator.sh/gpu-memory: 512Gi # Reported by koordinator\n      koordinator.sh/gpu-memory-ratio: "800" # Reported by koordinator\n      huawei.com/npu-core: "160" # Reported by ascend device plugin\n      huawei.com/npu-cpu: "56" # Reported by Koordinator\n      huawei.com/npu-dvpp: "800" # Reported Koordinator\n')),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"\u521b\u5efa Pod \u7533\u8bf7\u4f7f\u7528\u6607\u817e\u5361\uff0c\u6837\u4f8b\u5982\u4e0b\uff0c\u793a\u4f8b\u4e2d\u7533\u8bf7\u4e86\u6574\u5361\u548c\u865a\u62df\u5361\u573a\u666f\u3002")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6ce8\u610f",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u6b64\u5904\u955c\u50cf\u4f7f\u7528\u4e86\u6607\u817e\u5b98\u65b9\u63d0\u4f9b\u7684\u63a8\u7406\u57fa\u7840\u955c\u50cf\uff0c\u7528\u6237\u53ef\u6839\u636e\u5b9e\u9645\u9700\u6c42\u9009\u62e9\u5408\u9002\u7684\u955c\u50cf"),(0,a.kt)("li",{parentName:"ul"},"resources.limits \u548c resources.requests \u4e2d\u5747\u9700\u8981\u989d\u5916\u914d\u7f6e\u8d44\u6e90",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u6574\u5361\u573a\u666f\uff0c\u4ee5 910B3 \u7684\u6574\u5361\u89c4\u683c\u4e3a\u4f8b\u5b50\u3002\u6607\u817e\u652f\u6301\u591a\u5361\u6574\u5361\u573a\u666f\u3002",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"huawei.com/npu-core",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u5355\u5361\u5305\u542b 20 \u4e2a npucore\uff0c\u7533\u8bf7 1 \u5361\u5219\u9700\u8981\u7533\u8bf7 20 \u4e2a npucore\u3002",(0,a.kt)("inlineCode",{parentName:"li"},"number_to_fill = card_count * npucore_per_card")),(0,a.kt)("li",{parentName:"ul"},"koordinator.sh/gpu-memory-ratio",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u6574\u5361\u573a\u666f\uff0c 1 \u5361\u5bf9\u5e94 100 \u7684 gpu-memory-ratio\u3002",(0,a.kt)("inlineCode",{parentName:"li"},"number_to_fill = card_count * 100")))))))),(0,a.kt)("li",{parentName:"ul"},"\u865a\u62df\u5361\u573a\u666f\uff0c\u4ee5 910B3 \u7684\u865a\u62df\u89c4\u683c ",(0,a.kt)("inlineCode",{parentName:"li"},"virt10_3c_32g")," \u4e3a\u4f8b\uff08\u53ef\u67e5\u8be2",(0,a.kt)("a",{parentName:"li",href:"#%E6%98%87%E8%85%BE%E5%8D%A1%E8%99%9A%E6%8B%9F%E8%A7%84%E6%A0%BC%E8%AF%B4%E6%98%8E"},"\u6607\u817e\u5361\u865a\u62df\u89c4\u683c\u8bf4\u660e"),"\uff09\uff0c \u89c4\u683c\u8868\u793a\u7533\u8bf7 10 \u4e2a npucore\uff0c 3 \u4e2a npucpu\uff0c 32GB \u663e\u5b58\u3002",(0,a.kt)("strong",{parentName:"li"},"\u6607\u817e\u4e0d\u652f\u6301\u914d\u7f6e\u591a\u5361\u865a\u62df\u5316"),"\u3002",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"koordinator.sh/gpu.shared",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u7533\u8bf7\u865a\u62df\u5361\u586b\u5199 1 \u5373\u53ef\u3002"))),(0,a.kt)("li",{parentName:"ul"},"koordinator.sh/gpu-memory",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u7533\u8bf7 1 \u865a\u62df\u5361\u5219\u9700\u8981\u7533\u8bf7 32GB \u7684 gpu-memory\u3002",(0,a.kt)("inlineCode",{parentName:"li"},"number_to_fill = gpu-memory_in_spec"),"\u3002"))),(0,a.kt)("li",{parentName:"ul"},"huawei.com/npu-core",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u7533\u8bf7 1 \u865a\u62df\u5361\u5219\u9700\u8981\u7533\u8bf7 10 \u4e2a npucore\u3002",(0,a.kt)("inlineCode",{parentName:"li"},"number_to_fill = npucore_in_spec"),"\u3002"))),(0,a.kt)("li",{parentName:"ul"},"huawei.com/npu-cpu",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u7533\u8bf7 1 \u865a\u62df\u5361\u5219\u9700\u8981\u7533\u8bf7 3 \u4e2a npucpu\u3002",(0,a.kt)("inlineCode",{parentName:"li"},"number_to_fill = npucpu_in_spec"),"\u3002"))),(0,a.kt)("li",{parentName:"ul"},"huawei.com/npu-dvpp",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"\u7533\u8bf7 1 \u865a\u62df\u5361\u5219\u9700\u8981\u7533\u8bf7 0 \u7684 dvpp\u3002\u76f4\u63a5\u67e5\u89c4\u683c\u8868\u5373\u53ef\u3002 ",(0,a.kt)("inlineCode",{parentName:"li"},"number_to_fill = dvpp_in_spec"))))))))))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:"full-card","full-card":!0},'apiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    app: demo-sleep\n  name: test-ascend-full-1\n  namespace: default\nspec:\n  containers:\n  - command:\n    - sleep\n    - infinity\n    image: swr.cn-south-1.myhuaweicloud.com/ascendhub/ascend-infer:24.0.0-ubuntu20.04\n    imagePullPolicy: IfNotPresent\n    name: demo-sleep\n    resources:\n      limits:\n        cpu: "32"\n        memory: 64Gi\n        koordinator.sh/gpu-memory-ratio: "100" # card_count * 100\n        huawei.com/npu-core: "20" # card_count * npucore_per_card\n      requests:\n        cpu: "32"\n        memory: 64Gi\n        koordinator.sh/gpu-memory-ratio: "100" \n        huawei.com/npu-core: "20" \n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:"partial-card","partial-card":!0},'apiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    app: demo-sleep\n  name: test-ascend-partial-1\n  namespace: default\nspec:\n  containers:\n  - command:\n    - sleep\n    - infinity\n    image: swr.cn-south-1.myhuaweicloud.com/ascendhub/ascend-infer:24.0.0-ubuntu20.04\n    imagePullPolicy: IfNotPresent\n    name: demo-sleep\n    resources:\n      limits:\n        cpu: "32"\n        memory: 64Gi\n        koordinator.sh/gpu.shared: "1"\n        koordinator.sh/gpu-memory: "32Gi" # gpu-memory_in_spec\n        huawei.com/npu-core: "10" # npucore_in_spec\n        huawei.com/npu-cpu: "3" # npucpu_in_spec\n      requests:\n        cpu: "32"\n        memory: 64Gi\n        koordinator.sh/gpu.shared: "1"\n        koordinator.sh/gpu-memory: "32Gi"\n        huawei.com/npu-core: "10"\n        huawei.com/npu-cpu: "3"\n')),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"\u8fdb\u5165\u5bb9\u5668\u5185\u90e8(",(0,a.kt)("inlineCode",{parentName:"li"},"kubectl exec -it {pod-name} --bash"),")\uff0c\u5728\u5bb9\u5668\u5185\u90e8\u6267\u884c ",(0,a.kt)("inlineCode",{parentName:"li"},"npu-smi")," \u547d\u4ee4\u67e5\u770b\u5361\u7684\u4f7f\u7528\u60c5\u51b5\u3002\u5982\u679c\u80fd\u591f\u6b63\u5e38\u663e\u793a\u6570\u636e\uff0c\u8868\u793a\u5361\u5df2\u7ecf\u6210\u529f\u5206\u914d\u5230 Pod \u4e2d\u3002")),(0,a.kt)("h3",{id:"\u6607\u817e\u5361\u865a\u62df\u89c4\u683c\u5217\u8868"},"\u6607\u817e\u5361\u865a\u62df\u89c4\u683c\u5217\u8868"),(0,a.kt)("p",null,"\u4e0b\u9762\u5217\u51fa\u4e86\u5e38\u89c1\u6607\u817e\u5361\u7684\u865a\u62df\u89c4\u683c\uff0c\u7528\u6237\u53ef\u6839\u636e\u5b9e\u9645\u9700\u6c42\u9009\u62e9\u5408\u9002\u7684\u865a\u62df\u89c4\u683c\u8fdb\u884c\u7533\u8bf7\u4f7f\u7528\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-\u6607\u817e\u865a\u62df\u5316\u89c4\u683c\u8bf4\u660e"},'huawei-Ascend-310P:\nvir01:\n  huawei.com/npu-core: "1"\n  huawei.com/npu-cpu: "1"\n  huawei.com/npu-dvpp: "12"\n  koordinator.sh/gpu-memory: 3Gi\nvir02:\n  huawei.com/npu-core: "2"\n  huawei.com/npu-cpu: "2"\n  huawei.com/npu-dvpp: "25"\n  koordinator.sh/gpu-memory: 6Gi\nvir02_1c:\n  huawei.com/npu-core: "2"\n  huawei.com/npu-cpu: "1"\n  huawei.com/npu-dvpp: "25"\n  koordinator.sh/gpu-memory: 6Gi\nvir04:\n  huawei.com/npu-core: "4"\n  huawei.com/npu-cpu: "4"\n  huawei.com/npu-dvpp: "50"\n  koordinator.sh/gpu-memory: 12Gi\nvir04_3c:\n  huawei.com/npu-core: "4"\n  huawei.com/npu-cpu: "3"\n  huawei.com/npu-dvpp: "50"\n  koordinator.sh/gpu-memory: 12Gi\nvir04_3c_ndvpp:\n  huawei.com/npu-core: "4"\n  huawei.com/npu-cpu: "3"\n  koordinator.sh/gpu-memory: 12Gi\nvir04_4c_dvpp:\n  huawei.com/npu-core: "4"\n  huawei.com/npu-cpu: "4"\n  huawei.com/npu-dvpp: "100"\n  koordinator.sh/gpu-memory: 12Gi\nhuawei-Ascend-310P3:\nvir01:\n  huawei.com/npu-core: "1"\n  huawei.com/npu-cpu: "1"\n  huawei.com/npu-dvpp: "12"\n  koordinator.sh/gpu-memory: 3Gi\nvir02:\n  huawei.com/npu-core: "2"\n  huawei.com/npu-cpu: "2"\n  huawei.com/npu-dvpp: "25"\n  koordinator.sh/gpu-memory: 6Gi\nvir02_1c:\n  huawei.com/npu-core: "2"\n  huawei.com/npu-cpu: "1"\n  huawei.com/npu-dvpp: "25"\n  koordinator.sh/gpu-memory: 6Gi\nvir04:\n  huawei.com/npu-core: "4"\n  huawei.com/npu-cpu: "4"\n  huawei.com/npu-dvpp: "50"\n  koordinator.sh/gpu-memory: 12Gi\nvir04_3c:\n  huawei.com/npu-core: "4"\n  huawei.com/npu-cpu: "3"\n  huawei.com/npu-dvpp: "50"\n  koordinator.sh/gpu-memory: 12Gi\nvir04_3c_ndvpp:\n  huawei.com/npu-core: "4"\n  huawei.com/npu-cpu: "3"\n  koordinator.sh/gpu-memory: 12Gi\nvir04_4c_dvpp:\n  huawei.com/npu-core: "4"\n  huawei.com/npu-cpu: "4"\n  huawei.com/npu-dvpp: "100"\n  koordinator.sh/gpu-memory: 12Gi\nhuawei-Ascend-910:\nvir02:\n  huawei.com/npu-core: "2"\n  huawei.com/npu-cpu: "1"\n  koordinator.sh/gpu-memory: 2Gi\nvir04:\n  huawei.com/npu-core: "4"\n  huawei.com/npu-cpu: "1"\n  koordinator.sh/gpu-memory: 4Gi\nvir08:\n  huawei.com/npu-core: "8"\n  huawei.com/npu-cpu: "3"\n  koordinator.sh/gpu-memory: 8Gi\nvir16:\n  huawei.com/npu-core: "16"\n  huawei.com/npu-cpu: "7"\n  koordinator.sh/gpu-memory: 16Gi\nhuawei-Ascend-910B1:\nvir03_1c_8g:\n  huawei.com/npu-core: "3"\n  huawei.com/npu-cpu: "1"\n  koordinator.sh/gpu-memory: 8Gi\nvir06_1c_16g:\n  huawei.com/npu-core: "6"\n  huawei.com/npu-cpu: "1"\n  koordinator.sh/gpu-memory: 16Gi\nvir12_3c_32g:\n  huawei.com/npu-core: "12"\n  huawei.com/npu-cpu: "3"\n  koordinator.sh/gpu-memory: 32Gi\nhuawei-Ascend-910B2:\nvir03_1c_8g:\n  huawei.com/npu-core: "3"\n  huawei.com/npu-cpu: "1"\n  koordinator.sh/gpu-memory: 8Gi\nvir06_1c_16g:\n  huawei.com/npu-core: "6"\n  huawei.com/npu-cpu: "1"\n  koordinator.sh/gpu-memory: 16Gi\nvir12_3c_32g:\n  huawei.com/npu-core: "12"\n  huawei.com/npu-cpu: "3"\n  koordinator.sh/gpu-memory: 32Gi\nhuawei-Ascend-910B2C:\nvir03_1c_8g:\n  huawei.com/npu-core: "3"\n  huawei.com/npu-cpu: "1"\n  koordinator.sh/gpu-memory: 8Gi\nvir06_1c_16g:\n  huawei.com/npu-core: "6"\n  huawei.com/npu-cpu: "1"\n  koordinator.sh/gpu-memory: 16Gi\nvir12_3c_32g:\n  huawei.com/npu-core: "12"\n  huawei.com/npu-cpu: "3"\n  koordinator.sh/gpu-memory: 32Gi\nhuawei-Ascend-910B3:\nvir05_1c_16g:\n  huawei.com/npu-core: "5"\n  huawei.com/npu-cpu: "1"\n  koordinator.sh/gpu-memory: 16Gi\nvir10_3c_32g:\n  huawei.com/npu-core: "10"\n  huawei.com/npu-cpu: "3"\n  koordinator.sh/gpu-memory: 32Gi\nhuawei-Ascend-910B4:\nvir05_1c_8g:\n  huawei.com/npu-core: "5"\n  huawei.com/npu-cpu: "1"\n  huawei.com/npu-dvpp: "25"\n  koordinator.sh/gpu-memory: 8Gi\nvir10_3c_16g:\n  huawei.com/npu-core: "10"\n  huawei.com/npu-cpu: "3"\n  huawei.com/npu-dvpp: "50"\n  koordinator.sh/gpu-memory: 16Gi\nvir10_3c_16g_nm:\n  huawei.com/npu-core: "10"\n  huawei.com/npu-cpu: "3"\n  koordinator.sh/gpu-memory: 16Gi\nvir10_4c_16g_m:\n  huawei.com/npu-core: "10"\n  huawei.com/npu-cpu: "4"\n  huawei.com/npu-dvpp: "100"\n  koordinator.sh/gpu-memory: 16Gi\n')))}l.isMDXComponent=!0}}]);