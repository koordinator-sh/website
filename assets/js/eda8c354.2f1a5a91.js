"use strict";(self.webpackChunkkoordinator_sh=self.webpackChunkkoordinator_sh||[]).push([[9336],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>k});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=p(n),d=o,k=u["".concat(s,".").concat(d)]||u[d]||c[d]||a;return n?r.createElement(k,i(i({ref:t},m),{},{components:n})):r.createElement(k,i({ref:t},m))}));function k(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var p=2;p<a;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3004:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var r=n(7462),o=(n(7294),n(3905));const a={},i="Component Guide",l={unversionedId:"developer-guide/component-guide",id:"developer-guide/component-guide",title:"Component Guide",description:"Introduction",source:"@site/docs/developer-guide/component-guide.md",sourceDirName:"developer-guide",slug:"/developer-guide/component-guide",permalink:"/docs/next/developer-guide/component-guide",draft:!1,editUrl:"https://github.com/koordinator-sh/koordinator.sh/edit/main/docs/developer-guide/component-guide.md",tags:[],version:"current",lastUpdatedBy:"\u4e54\u666e",lastUpdatedAt:1760692701,formattedLastUpdatedAt:"Oct 17, 2025",frontMatter:{},sidebar:"docs",previous:{title:"Running Hadoop YARN with K8s by Koordinator",permalink:"/docs/next/best-practices/colocation-of-hadoop-yarn"},next:{title:"Metrics Collection",permalink:"/docs/next/developer-guide/metrics-collection"}},s={},p=[{value:"Introduction",id:"introduction",level:2},{value:"koord-manager",id:"koord-manager",level:2},{value:"koord-scheduler",id:"koord-scheduler",level:2},{value:"koordlet",id:"koordlet",level:2},{value:"koord-descheduler",id:"koord-descheduler",level:2},{value:"koord-device-daemon",id:"koord-device-daemon",level:2},{value:"koord-runtime-proxy",id:"koord-runtime-proxy",level:2},{value:"Component Communication and Integration",id:"component-communication-and-integration",level:2},{value:"Operational Considerations",id:"operational-considerations",level:2},{value:"Performance and Scaling",id:"performance-and-scaling",level:2},{value:"Security and Best Practices",id:"security-and-best-practices",level:2}],m={toc:p},u="wrapper";function c(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"component-guide"},"Component Guide"),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,"Koordinator is a QoS-based scheduling system that enhances Kubernetes cluster efficiency and reliability for hybrid workloads. This guide documents each component's purpose, architecture, configuration, and operations. Components communicate through the Kubernetes API server and share configuration via ConfigMaps for coordinated resource management."),(0,o.kt)("h2",{id:"koord-manager"},"koord-manager"),(0,o.kt)("p",null,"The koord-manager is Koordinator's control plane, managing CRDs and webhooks while coordinating subsystems through leader election. It initializes controllers, webhooks, and shared informers for cluster event processing."),(0,o.kt)("p",null,"Key configuration options:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--enable-leader-election"),": Enable high availability"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--metrics-addr"),": Expose monitoring metrics"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--feature-gates"),": Control alpha/beta features"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--config-namespace"),": Specify configuration namespace"),(0,o.kt)("li",{parentName:"ul"},"Webhook server: Runs on port 9876 for admission control")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Component Interaction:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"koord-manager\n  \u251c\u2500\u2500 Webhook Server (Port 9876)\n  \u251c\u2500\u2500 Leader Election (High Availability)\n  \u251c\u2500\u2500 Coordinates with koord-scheduler\n  \u2514\u2500\u2500 Coordinates with koordlet\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Diagram sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-manager/main.go#L1-L223"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/server.go#L1-L161"},"server.go"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Section sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-manager/main.go#L61-L79"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/server.go#L47-L102"},"server.go"))),(0,o.kt)("h2",{id:"koord-scheduler"},"koord-scheduler"),(0,o.kt)("p",null,"The koord-scheduler extends Kubernetes scheduler with advanced capabilities for co-located workloads through a plugin-based architecture."),(0,o.kt)("p",null,"Configuration uses the ",(0,o.kt)("inlineCode",{parentName:"p"},"--config")," flag pointing to a YAML file (typically ",(0,o.kt)("inlineCode",{parentName:"p"},"koord-scheduler-config")," ConfigMap). The configuration extends Kubernetes scheduler schema with Koordinator-specific components."),(0,o.kt)("p",null,"Key scheduling plugins:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"LoadAwareScheduling"),": Real-time node resource utilization"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"NodeNUMAResource"),": NUMA-aware CPU and memory allocation"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Reservation"),": Resource reservation with preemption support"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"ElasticQuota"),": Dynamic quota allocation and eviction"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Coscheduling"),": Gang scheduling for pod groups"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"DeviceShare"),": Shared device management (GPU, RDMA, FPGA)")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Scheduler Configuration Hierarchy:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Scheduler Configuration\n\u251c\u2500\u2500 Global Settings\n\u2502   \u2514\u2500\u2500 InsecureServing\n\u251c\u2500\u2500 Plugin Configurations\n\u2502   \u251c\u2500\u2500 LoadAwareScheduling (Load-aware scheduling)\n\u2502   \u251c\u2500\u2500 NodeNUMAResource (NUMA resource management)\n\u2502   \u251c\u2500\u2500 Reservation (Resource reservation)\n\u2502   \u251c\u2500\u2500 ElasticQuota (Elastic quota)\n\u2502   \u251c\u2500\u2500 Coscheduling (Gang scheduling)\n\u2502   \u2514\u2500\u2500 DeviceShare (Device sharing)\n\u2514\u2500\u2500 Framework Extensions\n    \u2514\u2500\u2500 ServicesEngine\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Diagram sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-scheduler/app/config/config.go#L1-L52"},"config.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/apis/config/v1/types.go#L1-L322"},"types.go"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Section sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-scheduler/app/config/config.go"},"config.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/config/manager/scheduler.yaml"},"scheduler.yaml")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/apis/config/v1/types.go"},"types.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/scheduler/apis/config/v1/defaults.go"},"defaults.go"))),(0,o.kt)("h2",{id:"koordlet"},"koordlet"),(0,o.kt)("p",null,"The koordlet runs as a daemon on each node, collecting metrics, enforcing QoS policies, and managing runtime hooks."),(0,o.kt)("p",null,"Configuration uses ConfigMaps with these key settings:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"ConfigMap name and namespace"),(0,o.kt)("li",{parentName:"ul"},"States informer configuration"),(0,o.kt)("li",{parentName:"ul"},"Metric cache settings"),(0,o.kt)("li",{parentName:"ul"},"QoS manager configuration"),(0,o.kt)("li",{parentName:"ul"},"Runtime hook configuration"),(0,o.kt)("li",{parentName:"ul"},"Audit and prediction settings")),(0,o.kt)("p",null,"Architecture subsystems:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"MetricCache"),": Stores collected metrics with pluggable backends"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"MetricsAdvisor"),": Analyzes metrics for optimization recommendations"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"QOSManager"),": Enforces QoS policies and resource allocation"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"RuntimeHooks"),": Integrates with container runtimes"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Prediction"),": Provides resource usage prediction"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"StatesInformer"),": Maintains consistent pod and node state views")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"koordlet Daemon Components:")),(0,o.kt)("p",null,"Core components and responsibilities:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"daemon"),": Main daemon process containing subsystems",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"MetricAdvisor"),": Metrics analyzer",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Run(stopCh)"),": Run main loop"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"HasSynced()"),": Check sync status"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"StatesInformer"),": State notifier",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Run(stopCh)"),": Run main loop  "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"HasSynced()"),": Check sync status"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"MetricCache"),": Metrics cache",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Run(stopCh)"),": Run main loop"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"QOSManager"),": QoS manager",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Run(stopCh)"),": Run main loop"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"RuntimeHook"),": Runtime hooks",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Run(stopCh)"),": Run main loop"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"PredictServer"),": Prediction server",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Setup()"),": Setup dependencies"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Run(stopCh)"),": Run main loop"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"ResourceUpdateExecutor"),": Resource update executor",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"Run(stopCh)"),": Run main loop"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"extensionControllers"),": Extension controllers list")))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Diagram sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/koordlet/koordlet.go#L1-L210"},"koordlet.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/koordlet/config/config.go#L38-L72"},"config.go"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Section sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/koordlet/koordlet.go"},"koordlet.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/koordlet/config/config.go"},"config.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koordlet/main.go"},"main.go"))),(0,o.kt)("h2",{id:"koord-descheduler"},"koord-descheduler"),(0,o.kt)("p",null,"The koord-descheduler identifies and evicts pods to improve resource utilization and cluster balance through a modular, profile-based architecture."),(0,o.kt)("p",null,"Operates as a Kubernetes controller manager with:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Descheduler Core"),": Coordinates descheduling policies"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Controller Manager"),": Manages reconciliation loops for custom resources"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Profiles"),": Define enabled plugins and configurations"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Plugins"),": Implement descheduling strategies (deschedule, balance, filter, evict)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Informer Factory"),": Maintains cached cluster resource views"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Eviction Limiter"),": Controls pod eviction rate to prevent disruption")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"koord-descheduler Architecture:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"koord-descheduler\n\u251c\u2500\u2500 Descheduler Core\n\u2502   \u251c\u2500\u2500 Profiles\n\u2502   \u2502   \u251c\u2500\u2500 Deschedule Plugins\n\u2502   \u2502   \u251c\u2500\u2500 Balance Plugins\n\u2502   \u2502   \u251c\u2500\u2500 Filter Plugins\n\u2502   \u2502   \u2514\u2500\u2500 Evict Plugins\n\u2502   \u251c\u2500\u2500 Eviction Limiter\n\u2502   \u2514\u2500\u2500 Informer Factory\n\u2502       \u251c\u2500\u2500 Node Informer\n\u2502       \u251c\u2500\u2500 Pod Informer\n\u2502       \u2514\u2500\u2500 Custom Resource Informers\n\u2514\u2500\u2500 Controller Manager\n    \u251c\u2500\u2500 Migration Controller\n    \u2514\u2500\u2500 Drain Controller\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Diagram sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/descheduler/descheduler.go#L156-L240"},"descheduler.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-descheduler/app/server.go#L281-L319"},"server.go"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Section sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/descheduler/descheduler.go"},"descheduler.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-descheduler/app/server.go"},"server.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-descheduler/app/options/options.go"},"options.go"))),(0,o.kt)("h2",{id:"koord-device-daemon"},"koord-device-daemon"),(0,o.kt)("p",null,"The koord-device-daemon discovers and labels heterogeneous devices (GPUs, NPUs, etc.) on nodes, running as a daemon that periodically scans and updates node labels."),(0,o.kt)("p",null,"Key configuration flags:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--oneshot"),": Single execution mode"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--no-timestamp"),": Disable timestamp in labels"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--sleep-interval"),": Device discovery frequency"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--prints-output-file"),": Output file path for device info")),(0,o.kt)("p",null,"Architecture components:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Resource Feature Discovery"),": Discovers and processes device information"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Prints Writer"),": Outputs device information"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Manager Map"),": Registry for different hardware type device managers"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Configuration"),": Manages component configuration from files, environment, and CLI")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"koord-device-daemon Execution Flow:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"1. Start\n   \u2193\n2. Load Configuration\n   \u2193\n3. Create Printers\n   \u2193\n4. Generate Device Prints\n   \u2193\n5. Output Device Prints\n   \u2193\n6. Check Oneshot Mode\n   \u251c\u2500 Yes \u2192 Exit\n   \u2514\u2500 No \u2192 Sleep Interval\n              \u2193\n           Rerun Discovery\n              \u2193\n           Return to Step 4\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Diagram sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-device-daemon/main.go#L1-L262"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-device-daemon/config/v1/config.go#L1-L41"},"config.go"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Section sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-device-daemon/main.go"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-device-daemon/config/v1/config.go"},"config.go"))),(0,o.kt)("h2",{id:"koord-runtime-proxy"},"koord-runtime-proxy"),(0,o.kt)("p",null,"The koord-runtime-proxy acts as middleware between kubelet and container runtimes, intercepting CRI calls to apply resource management policies."),(0,o.kt)("p",null,"Key configuration flags:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--koord-runtimeproxy-endpoint"),": Service endpoint"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--remote-runtime-service-endpoint"),": Backend runtime service"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--backend-runtime-mode"),": Container engine (Containerd or Docker)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--runtime-hook-server-key/val"),": Runtime hook server identification")),(0,o.kt)("p",null,"Supports two backend modes:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Containerd"),": CRI server for Containerd runtime"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Docker"),": Docker server for Docker runtime")),(0,o.kt)("p",null,"Architecture:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Runtime Manager Server"),": Abstract interface for runtime implementations"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"CRI Server/Docker Server"),": Runtime-specific implementations"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Dispatcher"),": Routes CRI calls to handlers"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Resource Executor"),": Applies resource policies to containers")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"koord-runtime-proxy Workflow:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"koord-runtime-proxy\n\u251c\u2500\u2500 Runtime Proxy Endpoint\n\u251c\u2500\u2500 Backend Runtime Mode\n\u2502   \u251c\u2500\u2500 Containerd Mode\n\u2502   \u2502   \u2514\u2500\u2500 CRI Server\n\u2502   \u2514\u2500\u2500 Docker Mode\n\u2502       \u2514\u2500\u2500 Docker Server\n\u2514\u2500\u2500 Runtime Hook Server Key/Val\n    \u2514\u2500\u2500 Skip Hook Server Pods\n\nData Flow:\nIntercept CRI Calls \u2192 Apply Resource Policies \u2192 Forward to Backend Runtime\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Diagram sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-runtime-proxy/main.go#L1-L72"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-runtime-proxy/options/options.go#L1-L25"},"options.go"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Section sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-runtime-proxy/main.go"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-runtime-proxy/options/options.go"},"options.go"))),(0,o.kt)("h2",{id:"component-communication-and-integration"},"Component Communication and Integration"),(0,o.kt)("p",null,"Koordinator components communicate through the Kubernetes API server and share configuration via ConfigMaps in a control plane/data plane pattern."),(0,o.kt)("p",null,"Primary communication patterns:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"API Server Interactions"),": All components watch resources, update status, and create custom resources"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Shared Configuration"),": ConfigMaps mounted as volumes or accessed via API server"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Webhook Integration"),": koord-manager webhooks called during resource creation/updates"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Metrics Collection"),": koordlet collects node metrics for scheduler decisions"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Event Propagation"),": Events and status updates through API server")),(0,o.kt)("p",null,"Integration workflow:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"koord-manager initializes controllers and webhooks"),(0,o.kt)("li",{parentName:"ol"},"koord-scheduler registers with Kubernetes scheduler framework"),(0,o.kt)("li",{parentName:"ol"},"koordlet starts on each node and collects metrics"),(0,o.kt)("li",{parentName:"ol"},"koord-device-daemon discovers and labels node devices"),(0,o.kt)("li",{parentName:"ol"},"koord-runtime-proxy intercepts container runtime calls"),(0,o.kt)("li",{parentName:"ol"},"Components coordinate through API server shared state")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Component Communication Sequence:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Communication Flow:\n\n1. koord-manager \u2192 API Server\n   - Watch CRDs and ConfigMaps\n\n2. koord-scheduler \u2192 API Server\n   - Register as scheduler\n\n3. koordlet \u2192 API Server\n   - Report node metrics\n\n4. koord-device-daemon \u2192 API Server\n   - Update node device labels\n\n5. koord-runtime-proxy \u2192 API Server\n   - Intercept CRI calls\n\n6. API Server \u2192 koord-scheduler\n   - Provide scheduling metrics\n\n7. koord-scheduler \u2192 API Server\n   - Schedule pods with QoS policies\n\n8. API Server \u2192 koordlet\n   - Apply QoS policies to pods\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Diagram sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-manager/main.go"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-scheduler/main.go"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koordlet/main.go"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-device-daemon/main.go"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-runtime-proxy/main.go"},"main.go"))),(0,o.kt)("h2",{id:"operational-considerations"},"Operational Considerations"),(0,o.kt)("p",null,"Effective Koordinator operation requires attention to configuration, monitoring, troubleshooting, and lifecycle management."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Configuration Management"),": Configuration managed through ConfigMaps mounted as volumes or via API server. Changes typically require component restarts."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Monitoring and Metrics"),": All components expose Prometheus metrics including:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Component health and readiness"),(0,o.kt)("li",{parentName:"ul"},"API server request latencies and errors"),(0,o.kt)("li",{parentName:"ul"},"Resource utilization and efficiency"),(0,o.kt)("li",{parentName:"ul"},"Scheduling and descheduling performance"),(0,o.kt)("li",{parentName:"ul"},"QoS policy enforcement statistics")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Common Issues"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Webhook Timeouts: Increase timeout settings in large clusters"),(0,o.kt)("li",{parentName:"ul"},"Resource Starvation: Adjust QoS policies and limits"),(0,o.kt)("li",{parentName:"ul"},"Scheduling Failures: Verify node labels and taints/tolerations"),(0,o.kt)("li",{parentName:"ul"},"Metric Collection: Check koordlet connectivity and permissions"),(0,o.kt)("li",{parentName:"ul"},"Device Discovery: Verify device drivers and permissions")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Lifecycle Management"),": Manage components as standard Kubernetes workloads with appropriate resources, limits, and probes. Perform rolling updates carefully, especially for koord-manager webhooks."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Section sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-manager/main.go"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-scheduler/main.go"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koordlet/main.go"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-descheduler/main.go"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-device-daemon/main.go"},"main.go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/cmd/koord-runtime-proxy/main.go"},"main.go"))),(0,o.kt)("h2",{id:"performance-and-scaling"},"Performance and Scaling"),(0,o.kt)("p",null,"Performance and scalability depend on cluster size, workload characteristics, and configuration."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"koord-manager Scaling"),": Single replica sufficient for small/medium clusters. Large clusters may need multiple replicas. Tune webhook timeouts based on load."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"koord-scheduler Performance"),": Influenced by enabled plugins, policy complexity, and scheduling frequency. Optimize plugin configuration and use efficient informer caches."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"koordlet Resource Usage"),": Depends on metric collection frequency, monitored resources, and QoS policy complexity. Tune collection intervals and retention based on requirements."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Scaling Guidelines"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Monitor component resources and adjust requests/limits"),(0,o.kt)("li",{parentName:"ul"},"Scale koord-manager based on API server load"),(0,o.kt)("li",{parentName:"ul"},"Optimize scheduler plugins for workload patterns"),(0,o.kt)("li",{parentName:"ul"},"Tune metric collection frequency"),(0,o.kt)("li",{parentName:"ul"},"Use node affinity and taints for component placement")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Performance and Scaling Configuration Flow:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"Cluster Deployment Process:\n\n1. Cluster Deployment\n   \u2193\n2. Determine koord-manager Replicas\n   \u251c\u2500 Small Cluster \u2192 Deploy Single Replica\n   \u2514\u2500 Large Cluster \u2192 Deploy Multiple Replicas\n   \u2193\n3. Configure Webhook Settings\n   \u2193\n4. Set Webhook Timeouts\n   \u2193\n5. Configure Concurrency Settings\n   \u2193\n6. Configure Request Queue\n   \u2193\n7. Configure Retry Policy\n   \u2193\n8. Monitor Performance\n   \u2193\n9. Adjust Configuration as Needed\n   \u2193\n   Return to Step 3 (iterate as needed)\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Diagram sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/config/manager/manager.yaml#L1-L55"},"manager.yaml")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/server.go#L47-L102"},"webhook.go"))),(0,o.kt)("h2",{id:"security-and-best-practices"},"Security and Best Practices"),(0,o.kt)("p",null,"Deploy Koordinator securely with these best practices:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"RBAC Configuration"),": Define minimum required permissions for each component following least privilege principle. RBAC configs are in ",(0,o.kt)("inlineCode",{parentName:"p"},"config/rbac")," directory."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Network Security"),": Configure network policies to restrict component communication. Webhook server should only be accessible to API server."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Secret Management"),": Store sensitive configuration in Secrets, not ConfigMaps. Properly manage and rotate TLS certificates."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Production Best Practices"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Use dedicated namespaces for components"),(0,o.kt)("li",{parentName:"ul"},"Implement resource requests and limits"),(0,o.kt)("li",{parentName:"ul"},"Configure liveness and readiness probes"),(0,o.kt)("li",{parentName:"ul"},"Enable leader election for control plane components"),(0,o.kt)("li",{parentName:"ul"},"Regularly update to latest stable versions"),(0,o.kt)("li",{parentName:"ul"},"Monitor logs and metrics for issues"),(0,o.kt)("li",{parentName:"ul"},"Test configuration changes in non-production first"),(0,o.kt)("li",{parentName:"ul"},"Implement backup and recovery procedures")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Security Considerations"),":"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Audit component permissions regularly"),(0,o.kt)("li",{parentName:"ul"},"Keep components updated for security fixes"),(0,o.kt)("li",{parentName:"ul"},"Limit webhook timeouts to prevent DoS"),(0,o.kt)("li",{parentName:"ul"},"Use network policies to restrict communication"),(0,o.kt)("li",{parentName:"ul"},"Implement proper logging and monitoring"),(0,o.kt)("li",{parentName:"ul"},"Follow Kubernetes pod security best practices")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Section sources")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/config/manager/manager.yaml"},"manager.yaml")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/config/manager/scheduler.yaml"},"scheduler.yaml")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/config/manager/koordlet.yaml"},"koordlet.yaml")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/config/rbac"},"rbac")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/koordinator-sh/koordinator/tree/main/pkg/webhook/server.go"},"webhook.go"))))}c.isMDXComponent=!0}}]);